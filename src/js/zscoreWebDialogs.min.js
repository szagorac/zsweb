var zscore=function(e,t,i,n,r,o,a){"use strict";function s(e){this.message=e,this.name="ZScoreException"}function l(e,t,i,n,r,o,a,s){this.xStart=e,this.xEnd=t,this.yStart=i,this.yEnd=n,this.beatStartNum=r,this.beatStartDenom=o,this.beatEndNum=a,this.beatEndDenom=s}function c(e,t,i,n){this.id=e,this.no=t,this.imgFileName=i,this.imgFileUrl=n,this.isLoaded=!1,this.img=new Image,this.img.pageId=e}function d(e,t){this.id=Zn.idSectionBtnPrefix+t,this.no=e,this.class="sectionListButton",this.onclick="onSectionSelect('"+t+"')"}function f(){this.class="sectionListButtonDisabled",this.onclick=""}function u(e,t){this.onclick="onInstrumentSelect("+e+",'"+t+"')"}function m(){this.onclick=""}function v(){}function p(){if(!Jn.isInitialised){if(!(e&&t&&i&&n&&r))throw new s("Invalid libraries. Required: zsUtil, zsNet, zsSvg, zsAudio and zsMusic");e.setRunMode(xi),yi("init: "),I(),Gn=e.isTouchDevice(),Kn=e.isSafari(navigator),yi("init: IsTouch Device: "+Gn+" isSafari: "+Kn),Jn.fontCanvas=a.createElement("canvas"),Jn.canvasCtx=Jn.fontCanvas.getContext("2d"),e.listen("resize",o,q),e.listen("orientationchange",o,q),L(),H(),U(),O(),S(),Jn.isInitialised=!0}}function S(){}function I(){var t=e.getLocalParam(Sn);Ii(t)&&(t=e.generateRandomId(),e.storeLocalParam(Sn,t)),Jn.clientId=t,yi("clientId: "+Jn.clientId),i.setElementIdText(Zn.idClientId,Jn.clientId),C()}function g(){Jn.part.pages={}}function b(){T(Jn.topStave),T(Jn.bottomStave)}function y(t){if(!Ii(t)&&!Ii(t.config)){var i=t.config;e.removeChildren(i.ovrlPitchStaveInfoId)}}function T(t){if(!Ii(t)&&!Ii(t.config)){var i=t.config;e.setElementIdAttributes(i.positionLineId,i.posLineConf),e.setElementIdAttributes(i.beatBallId,i.posBallConf)}}function x(){Jn.isInitialised?(yi("onStateBtnClick: zscore initialised"),t.isConnected()||(yi("onStateBtnClick: zscore not connected, reconnecting..."),J())):(yi("onStateBtnClick: initialising"),p())}function P(t){e.arrContains(Jn.score.parts,t)?(Jn.part.name=t,lt(t),e.makeInVisible(Zn.idPartsListOuterDiv)):yi("onPartSelection: unexpected part: "+t)}function h(t){e.arrContains(Jn.score.sections,t)?(E(t),ut(t)):yi("onSectionSelection: unexpected section: "+t)}function E(t){var i=Zn.idSectionBtnPrefix+t,n=e.getElement(i);Ii(n)||k(n)}function k(t){Ii(t)||e.setElementAttributes(t,new f)}function A(){var t=e.getElement(Zn.idOwnedSections);if(!Ii(t)){for(var i=Jn.score.mySections,n="",r="",o=0;o<i.length;o++)n=n+r+i[o],r="; ";e.setText(t,n)}}function B(e,t){Ii(e)||Ii(t)||Ii(Jn.part.name)||(ft(e,t,Jn.part.name),Vt())}function C(){var t=Jn.isClientIdVisible;t?e.makeVisible(Zn.idClientId):e.makeInVisible(Zn.idClientId)}function M(){Jn.isClientIdVisible=!Jn.isClientIdVisible,C()}function N(e){if(x(),!Ii(e)){var t=r.getTransposition(e);Ii(t)||(Jn.transpo=t,zt(),Me())}}function w(){z()}function L(){t.init(Zn.connectionPreference,Zn.appUrlSse,Zn.appUrlWebsockets,Zn.appUrlHttp,$,Y)}function O(){var t=e.getElement(Zn.metro.idMetronomeRect);Ii(t)||(e.listen("click",t,V),R())}function R(){var t=e.getElement(Zn.metro.idMetroFreqLine),i=e.getElement(Zn.metro.idMetroFreqRect);if(gi(t)&&gi(i)){var n=e.toInt(t.getAttribute(Fi)),r=e.toInt(i.getAttribute(Hi)),o=Math.round(r/2),a=n-o;Jn.metro.slider.xMax=a;var s=e.toInt(t.getAttribute(_i)),l=s+o;Jn.metro.slider.xMin=l;var c=a-l;Jn.metro.slider.range=c;var d=Math.round((a+l)/2);Jn.metro.slider.xMid=d}Draggable.create(Zn.metro.ifMetroFreqSlider,{type:Di,bounds:document.getElementById(Zn.metro.idMetroFreqLine),onDrag:D})}function D(t){var i=gsap.getProperty(Zn.metro.ifMetroFreqSlider,Di),r=Jn.metro.slider.xMid+i,o=r-Jn.metro.slider.xMin,a=Math.round(100*o/Jn.metro.slider.range),s=e.mapRange(a,0,100,Zn.metro.minFreq,Zn.metro.maxFreq);s<200&&(s=200),n.setBeepFreqenecy(s),yi("onFreqSliderMove: freq: "+s)}function V(e){Jn.metro.isMetroOn?_():F()}function _(){n.switchMetro(!1),i.setElementIdHref(Zn.metro.idMetronome,Zn.metro.ifSymbolMetroOff),e.makeInVisible(Zn.metro.idMetroSlider),Jn.metro.isMetroOn=!1}function F(){n.switchMetro(!0),i.setElementIdHref(Zn.metro.idMetronome,Zn.metro.ifSymbolMetroOn),e.makeVisible(Zn.metro.idMetroSlider),Jn.metro.isMetroOn=!0}function U(){Ii(n)?bi("initAudio: invalid zsAudio lib"):n.init()}function z(){Ii(n)?bi("resetAudio: invalid zsAudio lib"):n.reset()}function H(){i.init()}function q(t){if(!e.isObject(this))return null}function Y(e,i){switch(e){case t.OPEN:X(i);break;case t.CLOSED:Q(i);break;case t.ERROR:W(i);break;default:bi("Unknown Connection Event State: "+e+" for type: "+i)}}function X(e){yi(e+" connection opened."),j(e)}function Q(e){yi(e+" connection closed."),G(e)}function W(e){yi(e+" connection error."),K(e)}function j(e){Jn.isConnected=!0,Jn.connectionType=e,Jn.reconnectAttmpts=0,Z(Zn.connectedRectStyle,Zn.connectedBtnAttrib,Zn.connectedTxtStyle,Bi),st()}function G(e){Jn.isConnected=!1,Z(Zn.disconnectedRectStyle,Zn.disconnectedBtnAttrib,Zn.disconnectedTxtStyle,Ni),J(e)}function K(e){Jn.isConnected=!1,Z(Zn.errorRectStyle,Zn.errorBtnAttrib,Zn.errorTxtStyle,wi),J(e)}function Z(t,i,n,r){var o=e.getElement(Zn.idServerStatusRect);Ii(o)||pi(o,t);var a=e.getElement(Zn.idServerStatusBtn);Ii(a)||Si(a,i);var s=e.getElement(Zn.idServerStatusTxt);Ii(s)||(pi(s,n),s.textContent=r)}function J(e){t.reconnect(e,!0)}function $(e,t){Jn.isConnected||j(),Ii(e)||(t||w(),gi(e.scoreInfo)&&ee(e.scoreInfo),gi(e.strategyInfo)&&te(e.strategyInfo),gi(e.partInfo)&&_e(e.partInfo),gi(e.pageInfo)&&xe(e.pageInfo),gi(e.mapInfo)&&le(e.mapInfo),gi(e.bpm)&&0!=e.bpm&&se(e.bpm),gi(e.actions)&&vt(e.actions))}function ee(t){if(e.isObject(t)){if(gi(t.partHtmlPage)){var i=re(t.partHtmlPage),n=e.getPageName();i&&t.partHtmlPage!==n&&e.loadPage(t.partHtmlPage)}if(gi(t.name)&&ne(t.name),gi(t.title)){var r=ie(t.title);r&&g()}gi(t.instruments)&&ot(t.instruments),gi(t.bpm)&&ae(t.bpm),gi(t.scoreDir)&&oe(t.scoreDir)}}function te(e){gi(e.strategies)&&Je(e.strategies)}function ie(e){return Jn.score.title!==e&&(Jn.score.title=e,i.setElementIdText(Zn.idTitle,e),!0)}function ne(t){Jn.score.noSpaceName=e.replaceEmptySpaces(t,hi)}function re(e){var t=Jn.score.htmlFile;return Ii(t)?(Jn.score.htmlFile=e,!1):t!==e&&(Jn.score.htmlFile=e,!0)}function oe(e){Jn.scoreDir!==e&&(Jn.scoreDir=e)}function ae(e){Jn.tempo!==e&&(Jn.tempo=e,i.setElementIdText(Zn.idTempoBpm,e))}function se(t){var i=e.toInt(t);if(!Ii(i)){var n=Jn.tempo,r=i/n;Jn.tempoModifier=r,ae(i),Jn.isPlaying?de(r):ue()}}function le(t){if(!Ii(t.map)&&!Ii(t.pageId)){t.pageId;var i=t.staveId,n=t.map,r=Jn[i];if(!Ii(r)){var o=r.config.xLeftMargin,a=JSON.parse(JSON.stringify(n));if(e.isArray(a)){for(var s={},l=0;l<a.length;l++)ce(s,a[l],o);r.beatMap=s,me(i)}}}}function ce(e,t,i){if(!(Ii(e)||Ii(t)||Ii(t.beatStartNum))){var n=t.beatStartNum,r=t.xStart+i,o=t.xEnd+i,a=new l(r,o,t.yStart,t.yEnd,n,t.beatStartDenom,t.beatEndNum,t.beatEndDenom);e[n]=a}}function de(e){fe(Jn.topStave.timeline,e),fe(Jn.bottomStave.timeline,e)}function fe(e,t){if(!Ii(e)){var i=e.timeScale(),n=i*t;e.timeScale(n)}}function ue(){ve(Jn.topStave),ve(Jn.bottomStave)}function me(e){Ii(e)||ve(Jn[e])}function ve(e){if(!Ii(e)){var t=gsap.timeline({onComplete:ge,onCompleteParams:[e.id],paused:!0}),i=e.beatMap;if(!Ii(i)){var n=e.config.positionLineId,o=e.config.beatBallId,a=e.config.ballYmax,s=!0;for(var l in i){var c=i[l],d=Jn.tempo,f=r.getBeatDurationSec(d),u=c.beatStartNum;if(s){var m=Zn.beatIdPrefix+(u-1),v=c.xStart,p=pe(n,0,v,m,0);t.add(p,qi);var S=Se(o,0,v,m);t.add(S,Yi),s=!1}v=c.xEnd,m=Zn.beatIdPrefix+u;var I=Zn.tweenIdPrefix+m,g=pe(n,f,v,m,u),b=Se(o,f,v,m),y=Ie(o,f/2,a,m);I=g.vars.id;t.addLabel(I,Yi),t.add(g,Yi),t.add(b,qi),t.add(y,I)}gi(e.currentBeat)&&Jt(t,e.currentBeat),e.timeline=t}}}function pe(t,i,n,r,o){var a=Zn.tweenIdPrefix+r;return gsap.to(e.toCssIdQuery(t),{id:a,duration:i,attr:{x1:n,x2:n},ease:"none",onStart:be,onStartParams:[r,o],onComplete:ye,onCompleteParams:[r,o]})}function Se(t,i,n,r){var o=Zn.ballTweenIdPrefix+r;return gsap.to(e.toCssIdQuery(t),{id:o,duration:i,attr:{cx:n},ease:"none"})}function Ie(t,i,n,r){var o=Zn.ballTweenIdPrefix+r;return gsap.to(e.toCssIdQuery(t),{id:o,duration:i,attr:{cy:n,r:2},ease:"power1.out",autoAlpha:.5,repeat:1,yoyo:!0})}function ge(e){Ti("onTimelineComplete stave: "+e);var t=Jn[e];gi(t)&&(t.isRunning=!1),gi(t.timeline)&&t.timeline.pause(0)}function be(e,t){var i=n.getCurrentTime();Jn.audioTlBeatTime=i,Ti("onBeatStart: beat: "+e+" beatNo: "+t+" beatTime: "+i),Te(t,e)}function ye(e,t){var i=n.getCurrentTime(),r=i-Jn.startTimeTl;Ti("onBeatEnd: beat: "+e+" beatNo: "+t+" elapsedTime: "+r)}function Te(t,i){e.isNumeric(t)&&(e.isNull(i)&&(i=Zn.beatIdPrefix+t),Jn.currentBeatId=i,Jn.currentBeatNo=t)}function xe(e){if(!Ii(e.staveId)){var t=e.staveId,i=Jn[t];Ii(i)?bi("processPageinfo: Invalid stave for id: {}",t):(gi(e.filename)&&(i.filename=e.filename),gi(e.pageId)&&(i.pageId=e.pageId),gi(e.rndPageId)?i.rndPageId=e.rndPageId:i.rndPageId=null,Pe(i),gi(e.transpositionInfo)&&he(e.transpositionInfo,i),Ne(i))}}function Pe(t){var i=e.getElement(t.config.ovrlPitchStaveInfoId);gi(i)&&e.removeElementChildren(i)}function he(e,t){Ii(e)||Ii(t)||(Ee(e.rectInfos,t),Ae(e.txtInfos,t))}function Ee(t,i){if(!Ii(t)){var n=e.getElement(i.config.ovrlPitchStaveInfoId);if(e.isArray(t))for(var r=0;r<t.length;r++)ke(t[r],n);else ke(t,n)}}function ke(t,n){if(!Ii(t)&&!Ii(n)){var r=null,o=null,a=null,s=null;if(gi(t.x)&&(r=t.x),gi(t.y)&&(o=t.y),gi(t.width)&&(a=t.width),gi(t.height)&&(s=t.height),!(Ii(r)||Ii(o)||Ii(a)||Ii(s))){var l=Zn.idTranspoInfo+Ce(),c=i.createRectangleElement(l);c.setAttribute("x",r),c.setAttribute("y",o),c.setAttribute("width",a),c.setAttribute("height",s),e.setElementAttributes(c,Zn.transpoExtRectAttrib),e.addChildToParent(n,c)}}}function Ae(t,i){if(!Ii(t)){var n=e.getElement(i.config.ovrlPitchStaveInfoId);if(e.isArray(t))for(var r=0;r<t.length;r++)Be(t[r],n);else Be(t,n)}}function Be(t,n){if(!Ii(t)&&!Ii(n)){var o=null,a=null,s=null;if(gi(t.x)&&(o=t.x),gi(t.y)&&(a=t.y),gi(t.txt)&&(s=t.txt),!(Ii(o)||Ii(a)||Ii(s))){var l=r.getPitch(s),c=r.PITCH_MOD.NATURAL;if(gi(l)){c=l.mod;var d=r.transpose(l,Jn.transpo);gi(d)&&(l=d,s=d.pitchName,c=d.mod)}var f=Zn.idTranspoInfo+Ce(),u=i.createTextElement(f);u.setAttribute(Di,o),u.setAttribute(Vi,a),e.setElementAttributes(u,Zn.transpoInfoAttrib);var m=Zn.idTranspoInfo+Ce(),v=i.createTspanElement(m);if(i.setElementText(v,s),e.addChildToParent(u,v),gi(l)&&r.PITCH_MOD.NATURAL!==c&&gi(l.modUnicode)){var p=Zn.idTranspoInfo+Ce(),S=i.createTspanElement(p);e.setElementAttributes(S,Zn.transpoPitchModAttrib),v.setAttribute(Ui,-2),i.setElementText(S,l.modUnicode),e.addChildToParent(v,S)}else v.setAttribute(Ui,2);v.setAttribute(zi,Zn.transpoLetterDy),e.addChildToParent(n,u)}}}function Ce(){return++Jn.counter}function Me(){if(!Ii(Jn.transpo)){var e=Jn.transpo,t=r.PITCH.C;gi(e)&&(t=e.pitch),Ii(t)||(gi(t.pitchName)&&i.setElementIdText(Zn.idTranspoKey,t.pitchName),gi(t.modUnicode)&&i.setElementIdText(Zn.idTranspoMod,t.modUnicode))}}function Ne(t){if(!Ii(t)){var i=t.config;if(!Ii(i)){var n=null,r=t.pageId;gi(t.rndPageId)&&(r=t.rndPageId);var o=Oe(r);n=Ii(o)?Le(t.fileName):o.src;var a=e.getElement(i.imgId);a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n),a.setAttribute("href",n);var s=e.getElement(t.config.ovrlPitchStaveInfoId),l=!1;e.hasChildrenElements(s)&&(l=!0),Mt(i,l)}}}function we(t){if(!Ii(t)){var i=t.config;if(!Ii(i)){var n=t.fileName,r=e.getElement(i.imgId);r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n),r.setAttribute("href",n)}}}function Le(e){return Jn.scoreDir+Jn.score.noSpaceName+Ei+e}function Oe(e){var t=Jn.part.pages[e];return Ii(t)?null:t.img}function Re(e){var t=Jn.part.pages[e];gi(t)&&(t.isLoaded=!0),Jn.pageNoToLoad--,0===Jn.pageNoToLoad&&Ve(),De(Jn.pageNoToLoad)}function De(e){if(e>0){var t=Ci+" "+e;Z(Zn.errorRectStyle,Zn.errorBtnAttrib,Zn.errorTxtStyle,t)}else Z(Zn.connectedRectStyle,Zn.connectedBtnAttrib,Zn.connectedTxtStyle,Mi)}function Ve(){yi("onPageLoadComplete: ");var e=Jn.part.pages,t=!0;for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];n.isLoaded||(yi("onPageLoadComplete: page: "+i+" is not loaded, retying load"),Ye(n.no),t=!1)}t&&(yi("All Pages loaded: "),Jn.isReady=!0,ct())}function _e(t){if(gi(t.name)&&(Jn.part.name=t.name),gi(t.pageRanges)){var i=t.pageRanges;if(e.isArray(i))for(var n=0;n<i.length;n++)Ze(i[n]);else Ze(i)}gi(t.imgDir)&&(Jn.part.imgDir=t.imgDir),gi(t.imgPageNameToken)&&(Jn.part.imgPageNameToken=t.imgPageNameToken),gi(t.imgContPageName)&&(Jn.part.imgContPageName=t.imgContPageName),gi(t.contPageNo)&&(Jn.part.contPageNo=t.contPageNo),gi(t.currentSection)&&(Jn.part.currentSection=t.currentSection),Ue(),Fe()}function Fe(){var t=Jn.part.name,n=Jn.part.currentSection,r="";gi(n)&&(r+=e.capitalizeFirstLetter(n)+" - "),r+=t,i.setElementIdText(Zn.idInstrument,r)}function Ue(){var t=Jn.part,i=t.pageRanges;if(e.isArray(i)){Jn.part.pages=[];for(var n=0;n<i.length;n++)qe(i[n]);ze(),He()}}function ze(){var e=je();Jn.pageNoToLoad++,Xe(e)}function He(){var e=We();Jn.pageNoToLoad++,Xe(e)}function qe(t){if(e.isObject(t)){var i=1,n=1;gi(t.start)&&(i=e.toInt(t.start)),gi(t.end)&&(n=e.toInt(t.end));var r=Jn.pageNoToLoad+(n-i+1);Jn.pageNoToLoad=r;for(var o=i;o<=n;o++)Ye(o)}}function Ye(e){var t=Qe(e);Xe(t)}function Xe(e){if(!Ii(e)){var t=e.imgFileUrl;Ii(t)||e.loadImg(t,e.id)}}function Qe(t){var i=Ke(t),n=Jn.part.pages[i];if(gi(n))return n;var r=Jn.part.imgPageNameToken;r=Ii(r)?Ge(t):e.replace(r,Zn.pageNoToken,""+t);var o=Jn.part.imgDir+r;n=new c(i,t,r,o);return Jn.part.pages[i]=n,n}function We(){var e=Jn.part.contPageNo,t=Ke(e),i=Jn.part.pages[t];if(gi(i))return i;var n=Jn.part.imgContPageName,r=Jn.part.imgDir+n;i=new c(t,e,n,r);return Jn.part.pages[t]=i,i}function je(){var e=Jn.part.blankPageNo,t=Ke(e),i=Jn.part.pages[t];if(gi(i))return i;var n=Zn.blankPageUrl,r=Zn.blankPageUrl;i=new c(t,e,n,r);return Jn.part.pages[t]=i,i}function Ge(e){return Jn.score.noSpaceName+hi+instrumentName+"_page"+e+".png"}function Ke(e){return Zn.pageIdPrefix+e}function Ze(e){if(!(Ii(e)||Ii(e.start)||Ii(e.end))){var t=e.start,i=e.end,n={start:t,end:i};Jn.part.pageRanges=[],Jn.part.pageRanges.push(n)}}function Je(t){if(!Ii(t))if(e.isArray(t))for(var i=0;i<t.length;i++)$e(t[i]);else $e(t)}function $e(t){if(e.isObject(t))if(Ii(t.name))bi("processStrategies: invalid strategy name");else{var i=t.name;switch(i){case Wn:et(t);break;case jn:rt(t);break;default:bi("processStrategies: Unknown strategy: "+i)}}}function et(t){var i=!1;if(gi(t.isReady)&&(i=e.toBoolean(t.isReady)),gi(t.sections))if(Jn.score.sections.length>0&&(Jn.score.sections=[]),e.isArray(t.sections))for(var n=0;n<t.sections.length;n++)tt(t.sections[n]);else tt(t.sections);if(gi(t.assignmentType)&&(Jn.score.assignmentType=t.assignmentType),Jn.score.ownedSections=[],Jn.score.mySections=[],gi(t.sectionOwners))for(var r in t.sectionOwners){var o=t.sectionOwners[r];Jn.score.ownedSections.push(r),Jn.clientId===o&&Jn.score.mySections.push(r)}i?nt():it()}function tt(e){Ii(e)||Jn.score.sections.push(e)}function it(){var t=Jn.score.sections;if(!(t.length<1)){var i=e.getElement(Zn.idSections);if(!Ii(i)){for(var n=0;n<t.length;n++){var r=t[n],o=Zn.idSectionBtnPrefix+r,a=e.getElement(o);if(Ii(a)){var s=new d(n+1,r);a=e.createButton(s),e.setText(a,r),e.addChildToParent(i,a)}e.arrContains(Jn.score.ownedSections,r)&&k(a)}A(),e.makeVisible(Zn.idSectionsListOuterDiv)}}}function nt(){var t=e.getElement(Zn.idSections);Ii(t)||(e.removeElementChildren(t),e.makeInVisible(Zn.idSectionsListOuterDiv))}function rt(e){}function ot(t){var i=[];if(e.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];e.arrContains(Zn.filterOutParts,r)||i.push(r)}else e.arrContains(Zn.filterOutParts,r)||i.push(t);e.arrEquals(Jn.score.parts,i)||(Jn.score.parts=i),at(i)&&lt(Jn.part.name)}function at(t){if(Ii(Jn.part.name)||!e.isArray(t))return!1;for(var i=Jn.part.name,n=0;n<t.length;n++)if(i===t[n])return!0;return!1}function st(){var e=mt();t.sendEvent(In,e)}function lt(e){var i=mt(),n="C";gi(Jn.transpo)&&(n=Jn.transpo),i[Pn]=e,i[Fn]=n,t.sendEvent(gn,i)}function ct(){var e=mt();e[Pn]=Jn.part.name,t.sendEvent(bn,e)}function dt(e){var i=mt();i[hn]=e,t.sendEvent(yn,i)}function ft(e,i,n){var r=mt();r[Cn]=e,r[Mn]=i,r[Pn]=n,t.sendEvent(Tn,r)}function ut(e){var i=mt();i[Vn]=e,t.sendEvent(xn,i)}function mt(){var e=new v;return e[_n]=Jn.clientId,e}function vt(t){var i=null,n=[],r={};if(e.isArray(t))for(var o=0;o<t.length;o++){var a=t[o];gi(a.type)&&(i=a.type),gi(a.targets)&&(n=a.targets),gi(a.params)&&(r=a.params),pt(i,n,r)}}function pt(t,i,n){if(e.logDebug("doAction: "+t),!Ii(t))switch(t){case"PING":vi(n);break;case"START":St(di,i,null);break;case"STOP":ci();break;case"SEMAPHORE_ON":ni(n);break;case"SEMAPHORE_OFF":ri(n);break;case"ACTIVATE":St($t,i,n);break;case"BEAT":St(Kt,i,n);break;case"START_MARK":St(Wt,i,n);break;case"INSTRUMENT_SLOTS":_t(n);break;case"RESET_INSTRUMENT_SLOTS":Vt();break;case"RESET_STAVES":Rt();break;case"OVERLAY_ELEMENT":St(Pt,i,n);break;case"OVERLAY_LINE":St(yt,i,n);break;case"OVERLAY_COLOUR":St(It,i,n);break;case"OVERLAY_TEXT":St(ht,i,n);break;case"VOTE":ti(n);break;default:bi("doAction: Unknown actionType: "+t)}}function St(t,i,n){if(!Ii(t))if(e.isArray(i))for(var r=0;r<i.length;r++)t(i[r],n);else t(target,n)}function It(e,t){if(!Ii(t)&&!Ii(e)){var i=Jn[e],n=t[Nn],r=t[Dn];gt(i,n,r)}}function gt(e,t,i){if(!(Ii(e)||Ii(t)||Ii(i)))switch(t){case"SPEED":case"PRESSURE":case"POSITION":break;case"PITCH":bt(e.config.ovrlPitchId+Zn.idRectSuffix,i);break;case"DYNAMICS":bt(e.config.ovrlDynId+Zn.idRectSuffix,i);break;case"TIMBRE":bt(e.config.ovrlTimbreId+Zn.idRectSuffix,i);break;default:yi("setOverlayColour: unknown overlay type: "+t)}}function bt(t,i){e.setElementIdStyleProperty(t,{fill:i})}function yt(e,t){if(!Ii(t)&&!Ii(e)){var i=Jn[e],n=t[Nn],r=t[Ln];Tt(i,n,r)}}function Tt(e,t,i){if(!(Ii(e)||Ii(t)||Ii(i)))switch(t){case"POSITION":case"SPEED":case"PRESSURE":break;case"PITCH":xt(e.config.ovrlPitchId+Zn.idLineSuffix,i);break;case"DYNAMICS":xt(e.config.ovrlDynId+Zn.idLineSuffix,i);break;case"TIMBRE":xt(e.config.ovrlTimbreId+Zn.idLineSuffix,i);break;default:yi("setOverlayLinePosition: unknown overlay type: "+t)}}function xt(t,n){var r=e.getElement(t);i.setLineY(r,n,n)}function Pt(e,t){if(!Ii(t)&&!Ii(e)){var i=Jn[e],n=t[Nn],r=t[wn],o=t[On],a=t[Rn];Et(i,n,r,o,a)}}function ht(e,t){if(!Ii(t)&&!Ii(e)){var i=Jn[e],n=t[Nn],r=t[On],o=t[Un],a=t[zn],s=t[Hn];kt(i,n,o,a,s,r)}}function Et(e,t,i,n,r){if(!Ii(e)&&!Ii(t)){var o=e.config;if(!Ii(o))switch(Ti("setOverlayElement: overlayType: "+t),t){case"SPEED":case"PRESSURE":case"POSITION":break;case"PITCH":Nt(o,i,n,r);break;case"DYNAMICS":Bt(o,i,n,r);break;case"TIMBRE":At(o,i,n,r);break;case"PITCH_STAVE":Ct(o,i,n,r);break;default:yi("setOverlayElement: unknown overlay type: "+t)}}}function kt(e,t,i,n,r,o){if(!Ii(e)&&!Ii(t)){var a=e.config;if(!Ii(a))switch(Ti("setOverlayText: overlayType: "+t),t){case"PITCH":wt(a,i,n,r,o);break;default:yi("setOverlayElement: unknown overlay type: "+t)}}}function At(e,t,i,n){if(!Ii(t)&&!Ii(e))switch(t){case"TIMBRE_BOX":Ot(e.ovrlTimbreId+Zn.idRectSuffix,i,n),Ot(e.ovrlTimbreId+Zn.idOrdSuffix+Zn.idLineSuffix,i,n),Ot(e.ovrlTimbreId,i,n),i||Ot(e.ovrlTimbreId+Zn.idLineSuffix,i,n);break;case"TIMBRE_ORD_LINE":Ot(e.ovrlTimbreId+Zn.idOrdSuffix+Zn.idLineSuffix,i,n);break;case"TIMBRE_LINE":Ot(e.ovrlTimbreId+Zn.idLineSuffix,i,n);break;default:yi("setTimbreOverlay: unknown overlay element: "+t)}}function Bt(e,t,i,n){if(!Ii(t)&&!Ii(e))switch(t){case"DYNAMICS_BOX":Ot(e.ovrlDynId+Zn.idRectSuffix,i,n),Ot(e.ovrlDynId+Zn.idOrdSuffix+Zn.idLineSuffix,i,n),Ot(e.ovrlDynId,i,n),i||Ot(e.ovrlDynId+Zn.idLineSuffix,i,n);break;case"DYNAMICS_MID_LINE":Ot(e.ovrlDynId+Zn.idOrdSuffix+Zn.idLineSuffix,i,n);break;case"DYNAMICS_LINE":Ot(e.ovrlDynId+Zn.idLineSuffix,i,n);break;default:yi("setDynamicsOverlay: unknown overlay element: "+t)}}function Ct(e,t,i,n){if(!Ii(t)&&!Ii(e))switch(t){case"PITCH_STAVE_BOX":Ot(e.ovrlPitchStaveId+Zn.idRectSuffix,i,n),Ot(e.ovrlPitchStaveId,i,n),i||Ot(e.ovrlPitchStaveId+Zn.idLineSuffix,i,n);break;case"PITCH_STAVE_MID_LINE":Ot(e.ovrlPitchStaveId+Zn.idMidSuffix+Zn.idLineSuffix,i,n);break;default:yi("setPitchOverlay: unknown overlay element: "+t)}}function Mt(e,t){Ct(e,"PITCH_STAVE_BOX",t,1),Ct(e,"PITCH_STAVE_MID_LINE",t,1)}function Nt(e,t,i,n){if(!Ii(t)&&!Ii(e))switch(t){case"PITCH_BOX":Ot(e.ovrlPitchId+Zn.idRectSuffix,i,n),Ot(e.ovrlPitchId,i,n),i||Ot(e.ovrlPitchId+Zn.idLineSuffix,i,n);break;case"PITCH_LINE":Ot(e.ovrlPitchId+Zn.idLineSuffix,i,n);break;default:yi("setPitchOverlay: unknown overlay element: "+t)}}function wt(e,t,i,n,r){Ii(e)||Lt(e.ovrlPitchId,t,i,n,r)}function Lt(t,i,n,r,o){var a=e.getElement(t);if(!Ii(a)){var s=t+Zn.idTxtLineSuffix,l=s+"1",c=s+"2",d=s+"3",f=e.getChildElement(a,e.toCssIdQuery(l));Ii(f)||(f.style.opacity=0,e.setText(f,i));var u=e.getChildElement(a,e.toCssIdQuery(c));Ii(u)||(u.style.opacity=0,e.setText(u,n));var m=e.getChildElement(a,e.toCssIdQuery(d));Ii(m)||(m.style.opacity=0,e.setText(m,r));var v=t+Zn.idTxtSuffix;if(o){if(e.makeVisible(v),Zn.textSpanIsFadeIn){var p=Zn.textSpanFadeTimeSec,S=Zn.textSpanFadeStaggerTimeSec;Ii(f)||gsap.to(f,{duration:p,autoAlpha:1,ease:"power1.in"}),Ii(u)||gsap.to(u,{delay:S,duration:p,autoAlpha:1,ease:"power1.in"}),Ii(m)||gsap.to(m,{delay:2*S,duration:p,autoAlpha:1,ease:"power1.in"})}}else e.makeInVisible(v)}}function Ot(t,i,n){if(!Ii(t))if(i){var r=e.toFloat(n);e.isNumeric(r)||(r=1),e.setElementIdStyleProperty(t,{opacity:r}),e.makeVisible(t)}else e.makeInVisible(t)}function Rt(){Dt(Jn.topStave),Dt(Jn.bottomStave)}function Dt(e){Ii(e)||(e.pageId=Qn,e.rndPageId=null,e.filename=Xn,e.beatMap=null,e.timeline=null,e.isActive=!0,e.isPlaying=!1,e.currentBeat=null,T(e),y(e),we(e))}function Vt(){qt(),Ut()}function _t(e){if(!Ii(e)){var t=e[Bn];Ht(t),Ft()}}function Ft(){e.makeVisible(Zn.idInstControls)}function Ut(){e.makeInVisible(Zn.idInstControls)}function zt(){e.makeInVisible(Zn.idTranspoControls)}function Ht(t){if(!Ii(t)){var i=e.csvToArr(t);if(!(Ii(i)||i.length<=0)){var n=Jn.score.parts;if(!(Ii(n)||n.length<=0))for(var r=0;r<n.length;r++){var o=r+1;r<i.length?Yt(i[r],o):Xt(o)}}}}function qt(){var e=Jn.score.parts;if(!(Ii(e)||e.length<=0))for(var t=0;t<e.length;t++){var i=t+1;Qt(i)}}function Yt(t,n){if(!Ii(t)&&!Ii(n)){var r=Zn.idInstSlotTxtPrefix+n,o=Zn.idInstSlotBtnPrefix+n,a=Zn.idInstSlotPrefix+n,s=t===Jn.part.name;e.makeVisible(r),e.makeVisible(o),e.makeVisible(a),e.setElementIdAttributes(a,Zn.instSlotActiveAttrib),i.setElementIdText(r,t.trim()),e.setElementIdStyleProperty(r,Zn.instSlotTxtActiveStyle),s?e.setElementIdStyleProperty(o,Zn.instSlotBtnActiveInstStyle):e.setElementIdStyleProperty(o,Zn.instSlotBtnActiveStyle);var l=new u(n,t);e.setElementIdAttributes(o,l)}}function Xt(t){var n=Zn.idInstSlotTxtPrefix+t,r=Zn.idInstSlotBtnPrefix+t,o=Zn.idInstSlotPrefix+t;e.makeVisible(n),e.makeVisible(r),e.makeVisible(o),e.setElementIdAttributes(o,Zn.instSlotInActiveAttrib),i.setElementIdText(n,Pi),e.setElementIdStyleProperty(n,Zn.instSlotTxtInActiveStyle),e.setElementIdStyleProperty(r,Zn.instSlotBtnInActiveStyle);var a=new m;e.setElementIdAttributes(r,a)}function Qt(t){var i=Zn.idInstSlotTxtPrefix+t,n=Zn.idInstSlotBtnPrefix+t,r=Zn.idInstSlotPrefix+t;e.makeInVisible(i),e.makeInVisible(n),e.makeInVisible(r);var o=new m;e.setElementIdAttributes(n,o)}function Wt(e,t){if(!Ii(t)&&!Ii(e)){var n=Jn[e],r=t[An];if(!Ii(n)&&!Ii(r)){var o=n.beatMap;if(!Ii(o)){var a=o[r];if(!Ii(a)){var s=a.xStart-1,l=jt(n);i.setLineX(l,s,s),Gt(l,!0)}}}}}function jt(t){return e.getElement(t.config.startLineId)}function Gt(t,i){i?e.makeElementVisible(t):e.makeElementInVisible(t)}function Kt(e,t){if(!Ii(t)&&!Ii(e)){var i=Jn[e],n=t[An];Zt(i,n)}}function Zt(e,t){if(!Ii(e)&&!Ii(t)){var i=n.getCurrentTime();Ti("setStaveBeat: stave: "+e.id+" beat: "+t+" time: "+i),Jt(e.timeline,t),e.currentBeat=t}}function Jt(e,t){if(!Ii(e)){var i=Zn.tweenIdPrefix+Zn.beatIdPrefix+t,r=e.labels;i in r?(n.beep(),e.seek(i)):Ti("setTimelineBeat: Invalid beat "+i)}}function $t(e,t){if(!Ii(t)&&!Ii(e)){var i=Jn[e],n=t[En],r=t[kn];ei(i,n,r)}}function ei(t,i,n){if(!(Ii(t)||Ii(i)||Ii(n))){if(i)e.setElementIdStyleProperty(t.config.maskId,Zn.activeStaveStyle);else{e.setElementIdStyleProperty(t.config.maskId,Zn.inactiveStaveStyle);var r=jt(t);Gt(r,!1)}n&&fi(t.timeline)}}function ti(e){if(!Ii(e)){var t=e[qn],i=e[Yn];ii(t,i)}}function ii(t,i){var n=i;n<Zn.meterMaxVotes&&(n=Zn.meterMaxVotes);var r=Zn.meterBoxDefaultWidth,o={};if(0===t)o[Zn.meterBoxSizeDimension]=r,e.setElementIdAttributes(Zn.audienceMeterUpBoxId,o),e.setElementIdAttributes(Zn.audienceMeterDownBoxId,o);else if(t>0){t>n&&(t=n);var a=Math.floor(e.mapRange(t,0,n,1,Zn.meterBoxMaxSize));o[Zn.meterBoxSizeDimension]=a,e.setElementIdAttributes(Zn.audienceMeterUpBoxId,o),o[Zn.meterBoxSizeDimension]=0,e.setElementIdAttributes(Zn.audienceMeterDownBoxId,o)}else if(t<0){var s=Math.abs(t);s>n&&(s=n);a=Math.floor(e.mapRange(s,0,n,1,Zn.meterBoxMaxSize));o[Zn.meterBoxSizeDimension]=0,e.setElementIdAttributes(Zn.audienceMeterUpBoxId,o),o[Zn.meterBoxSizeDimension]=a,e.setElementIdAttributes(Zn.audienceMeterDownBoxId,o)}}function ni(e){Ii(e)||ai(e.lightNo,e.colourId)}function ri(e){Ii(e)||si(e.lightNo,en)}function oi(){si(4,en),si(1,Qi)}function ai(e,t){var i=li(t);si(e,i)}function si(t,n){if(!Ii(t)&&!Ii(n))for(var r=e.toInt(t),o=1;o<=r;o++){var a=Zn.idSemaphorePrefix+o;i.setElementIdColour(a,n)}}function li(e){var t;switch(e||(e=1),e){case 4:t=Qi;break;case 3:t=Wi;break;case 2:t=ji;break;case 1:default:t=Xi}return t}function ci(){ui(),Jn.isPlaying=!1,oi(),b()}function di(e){if(!Ii(e)){var t=Jn[e];if(!Ii(t)){var i=t.timeline;Ii(i)||(fi(i),Jn.isPlaying=!0)}}}function fi(e){if(Ii(e))bi("startTimeline: invalid timeline");else{var t=e.progress();t>0&&t<1?e.resume():e.play(0)}}function ui(){mi(Jn.topStave.timeline),mi(Jn.bottomStave.timeline),Jn.bottomStave.isPlaying=!1,Jn.topStave.isPlaying=!1}function mi(e){Ii(e)?bi("stopTimeline: invalid timeline"):e.pause()}function vi(t){e.isObject(t)&&gi(t.sendTimeMs)&&dt(t.sendTimeMs)}function pi(t,i){e.setElementStyleProperty(t,i)}function Si(t,i){e.setElementAttributes(t,i)}function Ii(t){return e.isNull(t)}function gi(t){return e.isNotNull(t)}function bi(t){e.logError(t)}function yi(t){e.log(t)}function Ti(t){e.logDebug(t)}const xi="dev",Pi="",hi="_",Ei="/",ki="AV",Ai="FullScore",Bi="Connected",Ci="Loading",Mi="READY",Ni="Reconnecting",wi="Error",Li="visible",Oi="hidden",Ri="none",Di="x",Vi="y",_i="x1",Fi="x2",Ui="dx",zi="dy",Hi="width",qi="<",Yi=">",Xi="green",Qi="red",Wi="orange",ji="yellow",Gi="white",Ki="black",Zi="blue",Ji="grey",$i="lightgrey",en=Ri,tn=en,nn=Gi,rn=Xi,on=Qi,an=Wi,sn=Zi,ln=Ji,cn=Xi,dn=Qi,fn=Wi,un=Gi,mn=Gi,vn=Ki,pn=6666,Sn="zsClientId",In="HELLO",gn="PART_REG",bn="PART_READY",yn="PING",Tn="SELECT_ISLOT",xn="SELECT_SECTION",Pn="part",hn="serverTime",En="isActive",kn="isPlay",An="beatNo",Bn="csvInstruments",Cn="slotNo",Mn="slotInstrument",Nn="overlayType",wn="overlayElement",Ln="overlayLineY",On="isEnabled",Rn="opacity",Dn="colour",Vn="section",_n="clientId",Fn="transposition",Un="l1",zn="l2",Hn="l3",qn="voteCount",Yn="voterNo",Xn="img/blankStave.png",Qn="p0",Wn="BUILDER",jn="RND";var Gn=null,Kn=null,Zn={connectionPreference:"ws,sse,poll",defaultConnectionType:t.WEBSOCKET,appUrlHttp:"/htp",appUrlSse:"/sse",appUrlWebsockets:"/wsoc",pageNoToken:"@PgNo@",instToken:"@Inst@",slotNoToken:"@SlotNo@",pageIdPrefix:"p",meterBoxDefaultWidth:1,meterBoxSizeDimension:"height",meterMaxVotes:10,meterBoxMaxSize:35,tsBaseBeatDenom:8,tsY:0,textSpanFadeTimeSec:1,textSpanFadeStaggerTimeSec:.5,textSpanIsFadeIn:!0,transpoLetterDy:"0.35em",beatIdPrefix:"b",tweenIdPrefix:"tw",beatTweenIdPrefix:"btw",ballTweenIdPrefix:"bltw",idTitle:"title",idServerStatusRect:"srvrStatusRect",idServerStatusTxt:"srvrStatusTxt",idServerStatusBtn:"srvrStatBtn",idParts:"parts",idPartsListOuterDiv:"partListOuterDiv",idSections:"sections",idSectionsListOuterDiv:"sectionListOuterDiv",idSectionBtnPrefix:"sectionBtn",idOwnedSections:"ownedSections",idInstrument:"part",idInstControls:"instControls",idTranspoControls:"transpositionListOuterDiv",idInstSlotPrefix:"instSlot",idInstSlotTxtPrefix:"instSlotTxt",idInstSlotBtnPrefix:"instSlotRect",idTempoBpm:"tmpBpm",idSemaphorePrefix:"semC",idLineSuffix:"Line",idBridgeSuffix:"Bridge",idOrdSuffix:"Ord",idMidSuffix:"Mid",idRectSuffix:"Rect",idTxtSuffix:"Txt",idTxtLineSuffix:"TxtLn",idClientIdGroup:"clientIdGroup",idClientId:"clientId",idTranspoKey:"transpoKey",idTranspoMod:"transpoMod",idTranspoInfo:"transpoInfo",blankPageUrl:"img/blankStave.png",audienceMeterUpBoxId:"audienceMeterUpBox",audienceMeterDownBoxId:"audienceMeterDownBox",filterOutParts:[ki,Ai],connectedRectStyle:{fill:rn,stroke:cn,"stroke-width":"0px",visibility:Li,opacity:1},disconnectedRectStyle:{fill:on,stroke:dn,"stroke-width":"1px",visibility:Li,opacity:1},errorRectStyle:{fill:an,stroke:fn,"stroke-width":"1px",visibility:Li,opacity:1},connectedTxtStyle:{fill:un},disconnectedTxtStyle:{fill:mn},errorTxtStyle:{fill:vn},activeStaveStyle:{fill:tn,stroke:sn,"stroke-width":"1px",visibility:Li,opacity:.5},inactiveStaveStyle:{fill:nn,stroke:ln,"stroke-width":"1px",visibility:Li,opacity:.4},instSlotBtnActiveStyle:{fill:Gi,stroke:Ki,"stroke-width":"1px",visibility:Li,opacity:1},instSlotBtnActiveInstStyle:{fill:"#d7f2cd",stroke:Ki,"stroke-width":"1px",visibility:Li,opacity:1},instSlotBtnInActiveStyle:{fill:$i,stroke:Ri,visibility:Li,opacity:1},instSlotTxtActiveStyle:{fill:Ki,visibility:Li,opacity:1},instSlotTxtInActiveStyle:{fill:Ki,stroke:Ri,visibility:Oi,opacity:0},instSlotActiveAttrib:{filter:"url(#dropshadow)"},instSlotInActiveAttrib:{filter:"none"},connectedBtnAttrib:{filter:""},disconnectedBtnAttrib:{filter:"url(#dropshadow)"},transpoInfoAttrib:{"font-family":"sans-serif","font-weight":"bold","font-size":"0.75em"},transpoPitchModAttrib:{dy:-1,dx:-1.5,"font-family":"sans-serif","font-weight":"bold","font-size":"0.75em"},transpoExtRectAttrib:{fill:Gi,stroke:Ri,visibility:Li,opacity:1},errorBtnAttrib:{filter:"url(#dropshadow)"},topStave:{gId:"stvTop",imgId:"stvTopImg",startLineId:"stvTopStartLine",positionLineId:"stvTopPosLine",beatBallId:"stvTopBeatBall",maskId:"stvTopMask",ovrlPosId:"ovrlTopPos",ovrlPitchId:"ovrlTopPitch",ovrlPitchStaveId:"ovrlTopPitchStave",ovrlPitchStaveInfoId:"ovrlTopPitchStaveInfo",ovrlSpeedId:"ovrlTopSpeed",ovrlPressId:"ovrlTopPres",ovrlDynId:"ovrlTopDyn",ovrlTimbreId:"ovrlTopTimb",ballYmax:84,xLeftMargin:31.5,posLineConf:{x1:"95",y1:"80",x2:"95",y2:"281"},posBallConf:{cx:"95",cy:"110",r:"4"}},bottomStave:{gId:"stvBot",imgId:"stvBotImg",startLineId:"stvBotStartLine",positionLineId:"stvBotPosLine",beatBallId:"stvBotBeatBall",maskId:"stvBotMask",ovrlPosId:"ovrlBotPos",ovrlPitchId:"ovrlBotPitch",ovrlPitchStaveId:"ovrlBotPitchStave",ovrlPitchStaveInfoId:"ovrlBotPitchStaveInfo",ovrlSpeedId:"ovrlBotSpeed",ovrlPressId:"ovrlBotPres",ovrlDynId:"ovrlBotDyn",ovrlTimbreId:"ovrlBotTimb",ballYmax:305,xLeftMargin:31.5,posLineConf:{x1:"95",y1:"301",x2:"95",y2:"502"},posBallConf:{cx:"95",cy:"331",r:"4"}},metro:{idMetronomeRect:"metroRect",idMetronome:"metro",idMetroSlider:"metroFreqSlider",idMetroFreqRect:"metroFreq",idMetroFreqLine:"metroFreqLine",ifSymbolMetroOff:"#metronome",ifSymbolMetroOn:"#metronomeOn",ifMetroFreqSlider:"#metroFreq",minFreq:220,maxFreq:2200}},Jn={clientId:null,isPlaying:!1,isReady:!1,score:{title:"ZScore",noSpaceName:"ZScore",htmlFile:null,instrument:"Part View",parts:["Part View"],firstPageNo:1,lastPageNo:2,sections:[],ownedSections:[],mySections:[],assignmentType:null},part:{name:"Part View",imgDir:null,imgPageNameToken:null,imgContPageName:null,blankPageNo:0,contPageNo:pn,currentSection:null,transpo:"C",pageRanges:[{start:1,end:1}],pages:{}},topStave:{id:"topStave",config:Zn.topStave,pageId:Qn,rndPageId:null,filename:Xn,beatMap:null,timeline:null,isActive:!0,isPlaying:!1,currentBeat:null,transpos:[]},bottomStave:{id:"bottomStave",config:Zn.bottomStave,pageId:Qn,rndPageId:null,filename:Xn,beatMap:null,timeline:null,isActive:!1,isPlaying:!1,currentBeat:null,transpos:[]},startTimeTl:0,currentBeatId:"b0",currentBeatNo:0,tempo:0,tempoModifier:1,scoreDir:"/score/",currentTickTimeSec:0,nextBeatTickTimeSec:0,
audioTlBeatTime:0,audioTickBeatTime:0,isConnected:!1,isInitialised:!1,connectionType:null,pageNoToLoad:0,metro:{isMetroOn:!1,slider:{xMax:60,xMin:40,xMid:50,range:20}},isClientIdVisible:!1,transpo:r.TRANSPOSITION.C,counter:0,voteCount:0};return c.prototype.loadImg=function(e){this.img.src=e,this.img.onload=function(){yi("pageImgOnLoad: id: "+this.pageId),Re(this.pageId)}},{onStateBtn:function(){x()},onPartSelect:function(e){P(e)},onSectionSelect:function(e){h(e)},onInstrumentSelect:function(e,t){B(e,t)},onClientIdSelect:function(){M()},onTranspoSelect:function(e){N(e)}}}(zsUtil,zsNet,zsSvg,zsWsAudio,zsMusic,window,document);