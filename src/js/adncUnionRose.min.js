var zscore=function(e,i,t,n,l,r){"use strict";function a(e){this.message=e,this.name="ZScoreException"}function s(e,i,t){this.value=e,this.isVisible=i,this.sizeMultiplier=t}function o(e,i,t,n,l,r,a,s,o,c,u,d){this.id=e,this.isSelected=i,this.isActive=t,this.isVisible=n,this.isPlaying=l,this.isPlayingNext=r,this.isPlayed=a,this.clickCount=s,this.arc=o,this.txt=u,this.modFill=c,this.playLine=d,this.playLineTl=null,this.tweens=[]}function c(e){this.id=e,this.tweens=[],this.selectedId=null}function u(){Ft("onLoad: "),d()}function d(){if(!(e&&i&&t&&n))throw new a("Invalid libraries. Required: zsUtil, zsNet, zsSvg and zsAudio");e.setRunMode(Lt),Ft("init: "),bn=e.isTouchDevice(),Pn=e.isSafari(navigator),Ft("init: IsTouch Device: "+bn+" isSafari: "+Pn),In.fontCanvas=r.createElement("canvas"),In.canvasCtx=In.fontCanvas.getContext("2d"),v(),g(),y(),x(),A(),O(),V(),z(),F(),p()}function f(){S(),T(),C(),m()}function v(){i.init(Cn.connectionPreference,Cn.appUrlSse,Cn.appUrlWebsockets,Cn.appUrlHttp,ut)}function p(){i.getServerState()}function h(){n.initSpeech(),n.initPlayer(),n.initGranulator(5)}function y(){wt(n)?zt("initAudio: invalid zsAudio lib"):n.init(Sn,h)}function m(){wt(n)?zt("resetAudio: invalid zsAudio lib"):n.reset()}function g(){t.init()}function x(){var i=!1,t=!1,n=!0,l=!1,r=!1,a=!1,u=0,d=new s(Mt,!1,1),f=new o(null,i,t,n,l,r,a,u,null,null,d,null);In.tiles=e.init2DArray(8,8,f);var v=new c(null);In.tileCircles=e.initArray(8,v)}function S(){for(var e=0;e<In.tiles.length;e++)for(var i=In.tiles[e],t=0;t<i.length;t++)b(In.tiles[e][t])}function b(i){P(i.id),i.isSelected=!1,i.isActive=!1,i.isVisible=!0,i.isPlaying=!1,i.isPlayingNext=!1,i.isPlayed=!1,i.clickCount=0,i.txt.value=Mt,i.txt.isVisible=!1,i.modFill=null;for(var t=0;t<i.tweens.length;t++){var n=i.tweens[t];wt(n)||n.pause(0)}var l=e.getElement(i.id);Oe(i,l)}function P(i){var t=Cn.tileGroupPrefix+i,n=e.getElement(t);wt(n)||(n.style.opacity="1")}function T(){I(In.centreShape),I(In.innerCircle),I(In.outerCircle)}function I(i){i.isVisible=!1,e.isFunction(i.gsapTimeline.pause)&&i.gsapTimeline.pause(0),e.isFunction(i.gsapTimeline.progress)&&i.gsapTimeline.progress(1,!0),e.isFunction(i.gsapExplodeTimeline.pause)&&i.gsapExplodeTimeline.pause(0)}function C(){Wi("centreShape")}function A(){E("centreShape",In.centreShape,Cn.circleRadii[1],Cn.circleRadii[7],!0),E("innerCircle",In.innerCircle,Cn.circleRadii[4],Cn.viewMaxPoint,!1),E("outerCircle",In.outerCircle,Cn.circleRadii[7],Cn.viewMaxPoint,!1)}function E(i,t,n,l,r){var a=e.getElement(i);if(wt(a))zt("Failed to find shape: "+i);else{Ft("initShape: shapeId: "+i),lt(a,t.isVisible);var s=Cn.shapeTimelineDuration;k(a,t,s,n),s=Cn.shapeExplodeDuration,w(a,t,s,l,r)}}function k(i,t,n,l){var r=gsap.timeline({paused:!0,ease:"power4.inOut",onComplete:Xe,onCompleteParams:[t]});t.gsapTimeline=r;var a=Cn.centre.x,s=Cn.centre.y,o=1,c=i.children;if(!wt(c)){Ft("initShapeTimeline: have : "+c.length+" children");for(var u=0;u<c.length;u++){var d=c[u];e.isEmptyString(d.id)&&(d.id="csh"+u);var f=d.getBBox(),v=f.x,p=f.y,h=He(a,s,l),y=e.randomIntFromInterval(0,360)*o;o*=-1;var m=e.randomFloatFromInterval(.1,2),g=h.x-v,x=h.y-p,S=d.id,b=gsap.from(e.toCssIdQuery(S),{x:g,y:x,rotation:y,scale:m});r.add(b,0)}r.totalDuration(n)}}function w(i,t,n,l,r){var a=gsap.timeline({paused:!0,ease:"slow",onComplete:qe,onCompleteParams:[t]});t.gsapExplodeTimeline=a;var s=Cn.centre.x,o=Cn.centre.y,c=i.children;if(!wt(c)){Ft("initShapeExplodeTimeline: have : "+c.length+" children");for(var u=0;u<c.length;u++){var d=c[u];e.isEmptyString(d.id)&&(d.id="csh"+u);var f=d.id,v=d.getBBox(),p=v.x,h=v.y,y=v.width,m=v.height,g=null;if(g=r?He(s,o,l):Qe(s,o,p,h,y,m,l),wt(g))return void zt("initShapeExplodeTimeline: calculated invalid random point");var x=g.x-p,S=g.y-h,b=gsap.to(e.toCssIdQuery(f),{x:x,y:S});a.add(b,0)}a.totalDuration(n)}}function V(){for(var e=Cn.circleRadii,i=Cn.centre,t=Cn.tileAngles,n=Cn.tileRotationDuration,l=Cn.tileRotationAngle,r=Cn.tileRotationYoyo,a=Cn.tileRotationReps,s=0;s<e.length;s++){var o=In.tileCircles[s];o.id=Cn.tileCircleGroupPrefix+(s+1);var c=Re(o.id,n,l,r,a);o.tweens.push(c),l*=-1;for(var u=e[s],d=1;d<t.length;d++){var f=t[d-1],v=t[d];R(i.x,i.y,u,f,v,s+1,d)}}}function z(){var i=In.tiles;if(e.isArray(i)){var n=Cn.centre,l=n.x,r=n.y,a=Cn.circleRadii[Cn.circleRadii.length-1]+1,s=Cn.outerFrameRadius,o=Cn.frameParentId,c=Cn.outerFrameId,u=t.createPathElement(c),d=Cn.frameStyle;kt(u,d);var f=t.createTorusPath(l,r,a,s);Vt(f)&&u.setAttribute("d",f),e.addChildToParentId(o,u)}else zt("createOuterFrame: invalid tiles")}function F(){var i=Cn.circleRadii[7]+2,n=Cn.centre,l=Cn.stageParentId,r=t.createSvgCircle(n.x,n.y,i,l);L(r),e.addChildToParentId(l,r)}function L(i){Cn.stageVisibilityStyle.opacity=In.stageAlpha,In.stageAlpha>0?Cn.stageVisibilityStyle.visibility=jt:Cn.stageVisibilityStyle.visibility=Bt,e.setElementAttributes(i,Cn.stageStyle),e.setElementStyleProperty(i,Cn.stageVisibilityStyle)}function M(){var i=Cn.stageParentId,t="c"+i,n=e.getElement(t);wt(n)||L(n)}function O(){var i=Pt();wt(i)||(Tn=i,e.listen("resize",l,ue),e.listen("orientationchange",l,ue),D("Welcome to","<span style='color:blueviolet;'>ZScore</span>","awaiting performance start ...",null,!0))}function D(e,i,t,n,l){if(!wt(Tn)){var r=!1;if(!wt(e)){var a=e.trim();In.instructions.l1!=a&&(In.instructions.l1=a,r=!0)}if(!wt(i)){a=i.trim();In.instructions.l2!=a&&(In.instructions.l2=a,r=!0)}if(!wt(t)){a=t.trim();In.instructions.l3!=a&&(In.instructions.l3=a,r=!0)}wt(n)||(In.instructions.bckgCol=n),l?r&&rt():ot()}}function R(i,n,l,r,a,s,o){var c=Cn.tilePrefix+e.toStr(s)+Cn.elementIdDelimiter+e.toStr(o),u=t.createPathElement(c);if(wt(u))zt("createSvgTile: Failed to create tile: "+c);else{var d=Cn.tileCircleGroupPrefix+e.toStr(s),f=Cn.tileGroupPrefix+c,v=t.createGroupElement(f);e.addChildToParentId(d,v),e.listen("mouseenter",v,ne),e.listen("mouseleave",v,le),e.listen("touchend",v,te),e.listen("mouseup",v,ie);u=t.createPathElement(c);e.addChildToParentId(f,u);var p=s-1,h=o-1,y=In.tiles[p][h];if(wt(y))zt("createSvgTile: Invalid tile state");else{y.id=c;var m=t.createArc(i,n,l,r,a);y.arc=m,Oe(y,u);var g=null;wt(y.txt)||(g=y.txt);var x=null;if(s<=1)x=t.createPieTilePath(i,n,m),G(i,n,l,r,a,o,c,f,g),N(y,i,n,m.endX,m.endY);else{var S=In.tiles[p-1][h],b=S.arc;x=t.createTorusTilePath(m,b),j(i,n,r,a,o,b,m,c,f,g),N(y,b.endX,b.endY,m.endX,m.endY)}Vt(x)&&u.setAttribute("d",x)}}}function N(e,i,n,l,r){var a=En+e.id;e.playLine=t.createSvgLine(i,n,l,r,0,a)}function G(i,n,l,r,a,s,o,c,u){var d=Cn.tileTextPathElementPrefix+o,f=t.createPathElement(d),v=Cn.tileStylePieTextPathElement,p=r+e.round((a-r)/2,1),h=i,y=n-l,m=null;s>4&&s<9?(m=t.createLinePath(h,y,i,n),v=Cn.tileStyleInvertedPieTextPathElement):m=t.createLinePath(i,n,h,y),f.setAttribute("d",m),t.rotateElement(f,p,i,n),u.sizeMultiplier=Cn.tileTextSizeMultiplier.pie,B(u,f,d,c,o,v)}function U(e,i,n,l,r,a){var s=Cn.selectedPrefix+r+a,o=t.createPathElement(s),c=Cn.shapeStyleInvisible,u=t.createLinePath(e,i,n,l);return o.setAttribute("d",u),kt(o,c),o}function j(e,i,n,l,r,a,s,o,c,u){var d=a.rX+(s.rX-a.rX)/2,f=t.createArc(e,i,d,n,l),v=t.invertArc(f);r>2&&r<7&&(v=f);var p=Cn.tileTextPathElementPrefix+o,h=t.createArcPath(v),y=t.createPathElement(p);y.setAttribute("d",h);var m=Cn.tileStyleTorusTextPathElement;u.sizeMultiplier=Cn.tileTextSizeMultiplier.torus,B(u,y,p,c,o,m)}function B(i,n,l,a,o,c){kt(n,Cn.tileStyleTextPathDef),e.addFirstChildToParent(Yi(),n);var u=t.createTextElement(Cn.tileTextElementPrefix+o);kt(u,Cn.tileStyleTextElement);var d=t.createTextPathElement(Cn.tileTextElementPathPrefix+o);d.setAttribute("href",e.toCssIdQuery(l)),kt(d,c);var f=t.createTspanElement(Cn.tileTextSpanPrefix+o);kt(f,Cn.tileStyleTextSpan);var v=r.createTextNode(Mt);f.appendChild(v),d.appendChild(f),u.appendChild(d),e.addChildToParentId(a,u);var p=Mt,h=1;e.isObjectInstanceOf(s,i)||(p=i.value,h=i.sizeMultiplier),W(p,n,f,h)}function W(i,t,n,l){if(!wt(n)&&!wt(t)){var r=n;if(!wt(r)){var a=r.textContent,s=Mt;if(e.isString(i)&&Mt!==i&&(s=i),a!==s){var o=s,c=o.length;if(c<Cn.tileTextMinLength)for(var u=Cn.tileTextMinLength-c,d=0;d<u;d++)o+=Dt;var f=t.getTotalLength(),v=l,p=e.getElement(Cn.testTextElementId);p.textContent=o;var h=10,y=Mt+h+"px";p.setAttribute("font-size",y);var m=p.getComputedTextLength();0===m&&(m=f);var g=f/m;h*=g*v,h=Math.floor(h),y=Mt+h+"px",Ft("setTileText: text: "+s+" pathLen: "+f+" testTextLen: "+m+" ratio: "+g+" fontSize: "+y),r.setAttribute("font-size",y),r.textContent=s}}}}function H(e){return wt(e)?null:e.isVisible?Cn.shapeStyleVisible:Cn.shapeStyleInvisible}function Q(e){return e.isVisible?Vt(e.txt)&&!e.txt.isVisible?Cn.tileStyleTextElementInvisible:Cn.tileStyleTextElement:Cn.tileStyleTextElementInvisible}function X(e){return wt(e)?Cn.tileStylePlayLineInactive:e.isPlaying?Cn.tileStylePlayLine:Cn.tileStylePlayLineInactive}function q(e){return e.isVisible?Cn.textStyleVisible:Cn.textStyleInvisible}function Y(e){return wt(e)?null:e.isPlaying?Cn.tileStyleOverlayPlaying:e.isPlayingNext?Cn.tileStyleOverlayPlayingNext:e.isSelected?Cn.tileStyleOverlaySelected:null}function Z(e){return wt(e)?null:e.isPlaying?Cn.tileStylePlaying:e.isPlayingNext?Cn.tileStylePlayingNext:e.isPlayed?Cn.tileStylePlayed:e.isVisible?e.isSelected?Cn.tileStyleSelected:e.isActive?Cn.tileStyleActive:Cn.tileStyleInActive:Cn.tileStyleInvisible}function _(){for(var i=e.initArray(In.tiles.length,null),t=0;t<In.tiles.length;t++)for(var n=In.tiles[t],l=0;l<n.length;l++){var r=In.tiles[t][l];if(r.isActive){var a=e.getElement(r.id),s=i[t];wt(s)&&(s=J(t),i[t]=s),K(a,r,s)}}}function J(i){var t=ee(i);if(wt(t))return null;var n=e.arrSortNumAsc(t);if(n.length<1)return null;var l=nn,r=$t-l.r,a=en-l.r,s=n[0],o=n[n.length-1];return s===o&&(r=0,a=0),[s,o,r,a]}function K(i,t,n){if(t.isActive){var l=tn,r=t.clickCount;if(!(r<0)){var a=$(t,n);l=e.modColour(l,a),t.modFill=l,i.setAttribute(Ut,l)}}}function $(i,t){var n=i.clickCount,l=Cn.colModPerClick*n;if(!e.isArray(t)||4!=t.length)return l;l=e.mapRange(n,t[0],t[1],t[2],t[3]);return l}function ee(i){var t=e.initArray(In.tiles[0].length,0);if(i<0||i>=In.tiles.length)return t;for(var n=In.tiles[i],l=0;l<n.length;l++){var r=In.tiles[i][l],a=r.clickCount;r.isPlayed&&(a=0),t[l]=a}return t}function ie(e){Ft("onMouseUp:"),bn||se(this)}function te(e){Ft("onTouchEnd:"),se(this)}function ne(e){bn||re(this)}function le(e){bn||ae(this)}function re(i){if(!e.isObject(i))return null;var t=i,n=i.id;if(xe(n)?n=Pe(n):ge(n)&&(n=Se(n)),!ye(n))return Ft("onElementPointerEntry: invalid tile id: "+n),null;t=e.getElement(n);var l=pe(n);Vt(l)&&l.isActive||kt(t,Cn.tileStyleOnPonterEntry)}function ae(i){if(e.isObject(i)){var t=fe(i);if(!wt(t)){var n=ve(t);wt(n)?Ft("onPointerLeave: invalid selected tile"):n.isActive||Oe(n,t)}}}function se(e){n.isReady()||y();var i=ve(e);wt(i)?Ft("processSelectedTile: invalid selected tile"):oe(i,e)}function oe(t,n){ce(t);var l=t.id,r=e.getElement(l);if(!wt(r)){var a=de(l),s=In.tileCircles[a.x];if(t.isActive||!t.isVisible){if(!(t.isPlaying||t.isPlayingNext||t.isPlayed)){if(l!==In.selectedTileId&&Vt(In.selectedTileId)){var o=pe(In.selectedTileId);o.isSelected=!1;var c=e.getElement(In.selectedTileId);Oe(o,c),Ce(o,c)}t.isSelected=!t.isSelected,t.isSelected&&(In.selectedTileId=l,s.selectedId=l),Oe(t,r),Ce(t,r);var u={};u[Nt]=t.id,u[Gt]=t.isSelected,i.sendEvent(Rt,u)}}else for(var d=s.tweens,f=0;f<d.length;f++){var v=d[f];bt(v)}}}function ce(i){var t=In.speech;t.isPlaySpeechSynthOnClick&&n.isSpeachReady()&&e.isString(t.speechText)&&fi(t.speechText,t.speechVoice,t.speechIsInterrupt,i)}function ue(i){if(!e.isObject(this))return null;rt()}function de(i){if(wt(i))return null;if(!e)return zt("getTileRowCol: invalid zsUtil"),null;var t=e.replace(i,Cn.tilePrefix,Mt),n=t.split(Cn.elementIdDelimiter);if(!e.isArray(n)||2!==n.length)return Ft("getTileState: invalid tile info: "+t),null;var l=e.toInt(n[0])-1,r=e.toInt(n[1])-1;return e.createPoint(l,r)}function fe(i){if(!e.isObject(i))return null;var t=i.id;return ye(t)?i:(xe(t)?t=Pe(t):ge(t)&&(t=Se(t)),wt(t)?null:e.getElement(t))}function ve(i){if(!e.isObject(i))return null;var t=i.id;return xe(t)?t=Pe(t):ge(t)&&(t=Se(t)),pe(t)}function pe(e){if(!ye(e))return Ft("getTileState: invalid tile id: "+e),null;var i=de(e);return wt(i)?null:In.tiles[i.x][i.y]}function he(i){return!(wt(i)||!e.isString(i))&&e.startsWith(i,kn)}function ye(i){return!(wt(i)||!e.isString(i))&&e.startsWith(i,Cn.tilePrefix)}function me(i){return!(wt(i)||!e.isString(i))&&e.startsWith(i,Cn.tileCircleGroupPrefix)}function ge(i){return!(wt(i)||!e.isString(i))&&e.startsWith(i,Cn.tileTextElementPrefix)}function xe(i){return!(wt(i)||!e.isString(i))&&e.startsWith(i,Cn.tileGroupPrefix)}function Se(i){if(wt(i)||!e.isString(i))return!1;var t=i.substring(Cn.tileTextElementPrefix.length,i.length);return ye(t)?t:null}function be(i){if(wt(i)||!e.isString(i))return!1;var t=i.substring(An,i.length);return ye(t)?t:null}function Pe(i){if(wt(i)||!e.isString(i))return!1;var t=i.substring(Cn.tileGroupPrefix.length,i.length);return ye(t)?t:null}function Te(i){if(wt(i)||!e.isString(i))return!1;var t=i.substring(Cn.tileCircleGroupPrefix.length,i.length),n=e.toInt(t)-1;if(!(n<0||n>=In.tileCircles.length))return In.tileCircles[n];zt("getCircleGroupIndexFromId: Invalid circle group index: "+n)}function Ie(i,t){if(!wt(i)&&!wt(t)){var n=t.id,l=Cn.tileTextPathElementPrefix+n,r=e.getElement(l);if(!wt(r)){var a=Cn.tileTextElementPrefix+n,o=e.getElement(a);if(!wt(o)){var c=Mt;wt(i)||wt(i.txt)||(c=i.txt);var u=Cn.tileTextSpanPrefix+n,d=e.getChildElement(o,e.toCssIdQuery(u));if(!wt(d)){var f=Mt,v=1;e.isObjectInstanceOf(s,c)||(f=c.value,v=c.sizeMultiplier),W(f,r,d,v)}}}}}function Ce(i,t){var n=i.id,l=Cn.overlayPrefix+n,r=e.getElement(l),a=Y(i);wt(a)?wt(r)||r.remove():(wt(r)&&(r=e.cloneElement(t,l)),kt(r,a),e.addChildToParentId(Cn.overlayParentId,r)),Ae(i)}function Ae(i){if(!wt(i.playLine)){var t=i.playLine.id,n=e.getElement(t);wt(n)&&(n=i.playLine),Vt(n)&&(Ee(i,n),e.addChildToParentId(Cn.overlayParentId,n))}}function Ee(e,i){if(!wt(i)){var t=X(e);Vt(t)&&kt(i,t)}}function ke(i){for(var t=[],n=[],l=null,r=null,a=0;a<In.tileCircles.length;a++){var s=In.tileCircles[a],o=s.selectedId;if(!wt(o)){var c=e.getElement(o);if(wt(c))zt("setSelectedTilesOverlay: can not find tile for selected id: "+o);else{var u=Cn.selectedPrefix+o,d=e.getElement(u);if(wt(d)&&(d=e.cloneElement(c,u),kt(d,Cn.shapeStyleInvisible),e.addChildToParentId(Cn.overlayParentId,d),t.push(d),a>0)){var f=pe(o);r=f;var v=Ve(a);wt(l)&&(l=v);var p=we(f,v);if(wt(p))continue;var h=e.getElement(p.id);if(!wt(h))continue;e.addChildToParentId(Cn.overlayParentId,p),n.push(p)}}}}p=we(l,r);if(!wt(p)){h=e.getElement(p.id);wt(h)&&(e.addChildToParentId(Cn.overlayParentId,p),n.push(p))}var y=e.getElement(Cn.overlayParentId),m=Cn.overlayInDuration;wt(i)||(m=i);var g=ze(y,m,Cn.outerFrameRadius);g.play();for(a=0;a<t.length;a++){var x=t[a];kt(x,Cn.tileStyleSelectedPath)}for(a=0;a<n.length;a++){x=n[a];kt(x,Cn.tileStyleConnectorPath)}}function we(e,i){if(wt(e)||wt(i))return null;var t=e.arc,n=i.arc;if(wt(t)||wt(n))return null;var l=t.startX,r=t.startY,a=n.endX,s=n.endY;return U(a,s,l,r,e.id,i.id)}function Ve(e){if(e<=0)return null;if(e>=In.tileCircles.length)return In.tileCircles[In.tileCircles.length-1];for(var i=e-1;i>=0;i--){var t=In.tileCircles[i],n=t.selectedId;if(!wt(n))return pe(n)}return null}function ze(i,t,n){var l=gsap.timeline({paused:!0,ease:"power4.inOut"}),r=Cn.centre.x,a=Cn.centre.y,s=1,o=i.children;if(!wt(o)){Ft("createSelectedTileTimeline: have : "+o.length+" children");for(var c=0;c<o.length;c++){var u=o[c];e.isEmptyString(u.id)&&(u.id="csh"+c);var d=u.getBBox(),f=d.x,v=d.y,p=d.width,h=d.height,y=Qe(r,a,f,v,p,h,n),m=e.randomIntFromInterval(0,360)*s;s*=-1;var g=e.randomIntFromInterval(5,15),x=y.x-f,S=y.y-v,b=u.id,P=gsap.from(e.toCssIdQuery(b),{x:x,y:S,rotation:m,scale:g});l.add(P,0)}return l.totalDuration(t),l}}function Fe(){e.removeChildren(Cn.overlayParentId)}function Le(){Fe();for(var e=0;e<In.tileCircles.length;e++){var i=In.tileCircles[e];i.selectedId=null}}function Me(e){e.isActive||(e.modFill=null)}function Oe(i,t){var n=Z(i);kt(t,n),i.isActive&&Vt(i.modFill)&&t.setAttribute(Ut,i.modFill);var l=Cn.tileTextElementPrefix+i.id,r=e.getElement(l);if(!wt(r)){var a=Q(i);kt(r,a)}}function De(i,t){var n=H(i),l=e.getElement(t);kt(l,n)}function Re(i,t,n,l,r){if(!wt(i)){var a=!1;Vt(l)&&(a=l);var s=0;return Vt(r)&&(s=r),gsap.from(e.toCssIdQuery(i),{duration:t,rotation:n,svgOrigin:Mt+Cn.centre.x+Ot+Cn.centre.y,onComplete:it,onCompleteParams:[i],paused:!0,yoyo:a,repeat:s,ease:"power1.inOut"})}zt("rotate: Invalid objectId: "+i)}function Ne(e){bt(e)}function Ge(e,i,t,n){if(wt(e))zt("initTilePlaylineTimeline: Invalid tileState");else{if(Vt(e.playLineTl))return e.playLineTl;if(!wt(i)){var l=i.id,r=gsap.timeline({paused:!0,ease:"none",onComplete:Ue,onCompleteParams:[e]});e.playLineTl=r;var a=Be(l,Cn.tilePlaylineAlphaDur,1);r.add(a,0);var s=je(l,t,n);r.add(s,0);var o=Be(l,Cn.tilePlaylineAlphaDur,0),c=">";return r.add(o,c),r}zt("initTilePlaylineTimeline: Invalid playline: ")}}function Ue(e){Ft("onTilePlaylineTimelineComplete: progress: "+e.playLineTl.progress())}function je(i,t,n){return gsap.to(e.toCssIdQuery(i),{duration:t,rotation:n,svgOrigin:Mt+Cn.centre.x+Ot+Cn.centre.y,onComplete:it,onCompleteParams:[i],yoyo:!1,repeat:0,ease:"none"})}function Be(i,t,n){return gsap.to(e.toCssIdQuery(i),{duration:t,autoAlpha:n,onComplete:tt,onCompleteParams:[i]})}function We(i,t,n){if(!wt(i))return gsap.to(e.toCssIdQuery(i),{duration:t,autoAlpha:n,onComplete:tt,onCompleteParams:[i],paused:!0});zt("dissolve: Invalid objectId: "+i)}function He(i,t,n){if(!e)return zt("getRandomPointInsideCircle: invalid zsUtil"),null;var l=2*Math.PI*Math.random(),r=Math.sqrt(Math.random()),a=n*r*Math.cos(l)+i,s=n*r*Math.sin(l)+t;return e.createPoint(a,s)}function Qe(i,t,n,l,r,a,s){var o=n-i,c=l-t,u=Math.sqrt(Math.pow(o,2)+Math.pow(c,2)),d=Math.sqrt(Math.pow(r,2)+Math.pow(a,2)),f=s+2*d,v=f/u,p=o*v,h=c*v,y=e.round(n+p,0),m=e.round(l+h,0);return e.createPoint(y,m)}function Xe(e){Ft("onShapeTimelineComplete: progress: "+e.gsapTimeline.progress())}function qe(e){Ft("onShapeExplodeTimelineComplete: progress: "+e.gsapExplodeTimeline.progress())}function Ye(i){if(e.isArray(i))for(var t=0;t<i.length;t++)Hi(i[t]);else Hi(i)}function Ze(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)qi(i,t[l],n);else qi(i,t,n)}function _e(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)Je(i,t[l],n);else Je(i,t,n)}function Je(e,i,t){if(!wt(i))switch(Ft("runAudio: "+e+Ot+i),i){case"all":Ke(e,t);break;case"player":$e(e,t);break;case"granulator":ei(e,t);break;case"speechSynth":ci(e,t)}}function Ke(i,t){if(e.isString(i))switch(i){case"volume":xi(t);break;default:return void zt("runPlayer: Unknown actionId: "+i)}}function $e(i,t){if(e.isString(i))switch(i){case"play":mi(t);break;case"volume":gi(t);break;default:return void zt("runPlayer: Unknown actionId: "+i)}}function ei(i,t){if(e.isString(i))switch(i){case"play":ii(t);break;case"stop":ti(t);break;case"config":oi(t);break;case"rampLinear":ni(t);break;case"rampSin":ri(t);break;case"volume":li(t);break;default:return void zt("runAudioGranulator: Unknown actionId: "+i)}}function ii(e){wt(n)?zt("runAudioPlayGranulator: Invalid zsAudio lib"):n.playGranulator()}function ti(e){wt(n)?zt("runAudioPlayGranulator: Invalid zsAudio lib"):n.stopGranulator()}function ni(i){if(wt(n))zt("runAudioPlayGranulator: Invalid zsAudio lib");else if(e.isObject(i)){var t=null,l=null,r=null;wt(i.paramName)||(t=i.paramName),wt(i.endValue)||(l=i.endValue),wt(i.duration)||(r=i.duration),n.setGranulatorRampLinear(t,l,r)}}function li(i){if(wt(n))zt("runAudioPlayGranulator: Invalid zsAudio lib");else if(e.isObject(i)){var t=null,l=null;wt(i.level)||(t=i.level),wt(i.timeMs)||(l=i.timeMs),n.setGranulatorGain(t,l)}}function ri(i){if(wt(n))zt("runAudioPlayGranulator: Invalid zsAudio lib");else if(e.isObject(i)){var t=null,l=null,r=null,a=null;wt(i.paramName)||(t=i.paramName),wt(i.amplitude)||(l=i.amplitude),wt(i.frequency)||(r=i.frequency),wt(i.duration)||(a=i.duration),n.setGranulatorRampSin(t,l,r,a)}}function ai(){wt(n)?zt("runAudioPlayGranulator: Invalid zsAudio lib"):n.resetGranulator()}function si(){Le()}function oi(i){wt(n)?zt("runAudioPlayGranulator: Invalid zsAudio lib"):e.isObject(i)&&n.setGranulatorConfig(i)}function ci(i,t){if(e.isString(i))switch(i){case"play":di(t);break;case"stop":vi(t);break;case"config":pi(t);break;case"state":hi(t);break;case"rampLinear":yi(t);break;case"volume":ui(t);break;default:return void zt("runSpeechSynth: Unknown actionId: "+i)}}function ui(i){if(wt(n))zt("setAudioSpeechVolume: Invalid zsAudio lib");else if(e.isObject(i)){var t=null,l=null;wt(i.level)||(t=i.level),wt(i.timeMs)||(l=i.timeMs),n.setSpeechVolume(t,l)}}function di(e){if(wt(n))zt("runPlaySpeechSynth: Invalid zsAudio lib");else if(wt(e))zt("runPlaySpeechSynth: Invalid params");else{var i=Mt,t="random",l=!1;wt(e.speechText)||(i=e.speechText),wt(e.speechVoice)||(t=e.speechVoice),wt(e.speechIsInterrupt)||(l=e.speechIsInterrupt);var r=In.playingTileId;wt(r)&&(r=In.selectedTileId);var a=pe(r);fi(i,t,l,a)}}function fi(i,t,l,r){if(!wt(i)){if(e.contains(i,gn)){var a=null;wt(r)||(a=r.txt),i=e.isString(a.value)?e.replace(i,gn,a.value):e.replace(i,gn,Mt)}n.speak(i,t,l)}}function vi(e){wt(n)?zt("runStopSpeechSynth: Invalid zsAudio lib"):n.stopSpeach()}function pi(e){wt(n)?zt("updateSpeechCofig: Invalid zsAudio lib"):n.setSpeechConfig(e)}function hi(i){if(e.isObject(i)){var t=In.speech;wt(i.isPlaySpeechSynthOnClick)||(t.isPlaySpeechSynthOnClick=i.isPlaySpeechSynthOnClick),wt(i.speechText)||(t.speechText=i.speechText),wt(i.speechVoice)||(t.speechVoice=i.speechVoice),wt(i.speechIsInterrupt)||(t.speechIsInterrupt=i.speechIsInterrupt)}else zt("setSpeechState: Invalid params")}function yi(i){if(e.isObject(i)){var t=null;wt(i.paramName)||(t=i.paramName);var l=null;wt(i.endValue)||(l=i.endValue);var r=null;wt(i.duration)||(r=i.duration),n.rumpLinearSpeechParam(t,l,r)}else zt("rampLinearSpeechParam: Invalid params")}function mi(i){if(wt(n))zt("runPlayerPlay: Invalid zsAudio lib");else if(e.isObject(i)){var t=0;wt(i.index)||(e.isString(i.index)?t=e.toInt(i.index):e.isNumeric(i.index)&&(t=i.index));var l=null,r=null,a=null;wt(i.startTime)||(l=i.startTime),wt(i.offset)||(r=i.offset),wt(i.duration)||(a=i.duration),n.playAudio(t,l,r,a)}}function gi(i){if(wt(n))zt("setAudioMasterVolume: Invalid zsAudio lib");else if(e.isObject(i)){var t=null,l=null;wt(i.level)||(t=i.level),wt(i.timeMs)||(l=i.timeMs),n.setPlayerVolume(t,l)}}function xi(i){if(wt(n))zt("setAudioMasterVolume: Invalid zsAudio lib");else if(e.isObject(i)){var t=null,l=null;wt(i.level)||(t=i.level),wt(i.timeMs)||(l=i.timeMs),n.setMasterVolume(t,l)}}function Si(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)bi(i,t[l],n);else bi(i,t,n)}function bi(i,t,n){if(e.isString(i)&&e.isObject(n))switch(Ft("rotate: "+t),i){case"start":Pi(t,n);break;case"reset":Ti(t,n);break;default:return void zt("Unknown rotate actionId: "+i)}}function Pi(i,t){var n=0,l=360;wt(t.duration)||(n=t.duration),wt(t.angle)||(l=t.angle);var r=null;if(ye(i)){var a=Cn.tileGroupPrefix+i,s=e.getElement(i),o=nt(s);e.isArray(o)&&o.length>0?r=o[0]:(r=Re(a,n,l),o.push(r))}else if(he(i)){r=null;var c=e.getElement(i),u=be(i),d=pe(u);if(wt(c)&&Vt(u)&&(Ae(d),c=e.getElement(d.playLine.id)),Vt(c)){var f=Ge(d,c,n,l);Ne(f)}}else if(me(i)){var v=Te(i);if(!wt(v)){var p=v.tweens;r=p,e.isArray(p)&&(r=p[0])}}bt(r)}function Ti(i,t){if(e.isString(i)&&ye(i)){var n=e.getElement(i),l=nt(n);if(e.isArray(l)&&l.length>0){var r=l[0];wt(r)||r.pause(0)}}}function Ii(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)Ci(i,t[l],n);else Ci(i,t,n)}function Ci(i,t,n){if(e.isString(i)&&e.isObject(n))switch(Ft("runAlpha: "+t),i){case"start":Ai(t,n);break;default:return void zt("Unknown aplha actionId: "+i)}}function Ai(i,t){var n=0;wt(t.duration)||(n=t.duration);var l=1;wt(t.value)||(l=t.value);var r=[];if(ye(i)){var a=Cn.tileGroupPrefix+i;r.push(We(a,n,l))}else switch(i){case Cn.stageParentId:if(In.stageAlpha===l)return;var s="c"+Cn.stageParentId,o=e.getElement(s);if(wt(o))return void zt("Invalid stage circle id: "+s);r.push(We(s,n,l))}for(var c=0;c<r.length;c++)Ft("runAlphaStart: tween: "+i),bt(r[c])}function Ei(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)ki(i,t[l],n);else ki(i,t,n)}function ki(i,t,n){if(e.isString(i))switch(Ft("reset: actionId: "+i+Ot+t),i){case"all":wi(t,n);break;case"elements":Vi(t,n);break;default:return void zt("Unknown reset actionId: "+i)}}function wi(i,t){if(e.isString(i))switch(i){case"tiles":S();break;case"shapes":T();break;case"elements":f();break;case"granulator":ai();break;case"selectedTiles":si();break;default:return void zt("Unknown reset target: "+i)}}function Vi(e,i){if(ye(e))b(pe(elementId));else switch(e){case"centreShape":return I(In.centreShape);case"innerCircle":return I(In.innerCircle);case"outerCircle":return I(In.outerCircle);case"zoom":return C();default:Ft("resetElements: unknown target: "+e)}}function zi(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)Fi(i,t[l],n);else Fi(i,t,n)}function Fi(i,t,n){if(e.isString(i))switch(Ft("runActivate: actionId: "+i+Ot+t),i){case"display":Li(t,n);break;default:return void zt("Unknown activate actionId: "+i)}}function Li(e,i){if(!wt(e))switch(Ft("runDisplayAction: target: "+e),e){case"selectedTiles":Mi(i)}}function Mi(e){Ft("runDisplaySelectedTiles: ");var i=null;wt(e)||wt(e.duration)||(i=e.duration),ke(i)}function Oi(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)Di(i,t[l],n);else Di(i,t,n)}function Di(i,t,n){if(e.isString(i))switch(Ft("runDeActivate: actionId: "+i+Ot+t),i){case"display":Ri(t,n);break;default:return void zt("Unknown DeActivate actionId: "+i)}}function Ri(e,i){if(!wt(e))switch(Ft("runDeActivateDisplayAction: target: "+e),e){case"overlays":Fe()}}function Ni(i,t,n){if(e.isArray(t))for(var l=0;l<t.length;l++)Gi(i,t[l],n);else Gi(i,t,n)}function Gi(i,t,n){if(e.isString(i))switch(Ft("stop: actionId: "+i+Ot+t),i){case"stop":Ui(t,n);break;default:return void zt("Unknown stop actionId: "+i)}}function Ui(e,i){if(!wt(e))switch(Ft("runStopAction: target: "+e),e){case"all":ji(i);break;case"granulator":ti(i);break;case"speechSynth":vi(i)}}function ji(e){Ft("runStopAll: "),!wt(n)&&n.isReady()&&(ti(e),vi(e))}function Bi(e){wt(e)||(In.stageAlpha=e,M())}function Wi(e){Ft("zoomLevel: "+e),wt(e)||Hi(e)}function Hi(e){var i=Yi();if(wt(i))Ft("zoom: invalid canvas");else{Ft("zoomTarget: "+e);var t=Xi(e);gsap.to(i,{attr:{viewBox:t},ease:"power3.out",duration:Cn.zoomDuration})}}function Qi(e){D(e.line1,e.line2,e.line3,e.colour,e.isVisible)}function Xi(i){switch(e.isString(i)||(i="default"),i){case"centreSmall":return Cn.zoomCentreSmall;case"centreShape":return Cn.zoomCentreShape;case"innerCircleSmall":return Cn.zoomInnerCircleSmall;case"innerCircle":return Cn.zoomInnerCircle;case"outerCircleSmall":return Cn.zoomOuterCircleSmall;case"outerCircle":default:return Cn.zoomFull}}function qi(i,t,n){if(e.isString(t)&&e.isString(i)){Ft("runTimeline: "+t);var l=null;switch(t){case"centreShape":l=In.centreShape.gsapTimeline;break;case"innerCircle":l=In.innerCircle.gsapTimeline;break;case"outerCircle":l=In.outerCircle.gsapTimeline;break;case"centreShapeExplode":l=In.centreShape.gsapExplodeTimeline;break;case"innerCircleExplode":l=In.innerCircle.gsapExplodeTimeline;break;case"outerCircleExplode":l=In.outerCircle.gsapExplodeTimeline;break;default:return void zt("runTimeline: invalid target: "+t)}switch(i){case"start":Zi(l,n);break;case"stop":_i(l);break;case"end":Ji(l);break;case"reset":Ki(l);break;case"reverse":et(l,n);break;case"resume":$i(l,n);break;default:return void zt("runTimeline: invalid actionId: "+i)}}}function Yi(){return e.getElement("svgCanvas")}function Zi(e,i){if(wt(e))zt("startTimeline: invalid timeline");else{if(!wt(i)&&!wt(i.duration)){var t=i.duration;e.totalDuration(t)}var n=e.progress();n>0?e.restart():e.play()}}function _i(e){wt(e)?zt("stopTimeline: invalid timeline"):e.pause()}function Ji(e){wt(e)?zt("endTimeline: invalid timeline"):e.pause(1)}function Ki(e){wt(e)?zt("stopTimeline: invalid timeline"):e.pause(0)}function $i(e,i){if(wt(e))zt("resumeTimeline: invalid timeline");else if(!e.isActive()){var t=e.totalDuration();if(!wt(i)&&!wt(i.duration))t=i.duration;var n=e.progress();1==n||0==n?(e.totalDuration(t),e.restart()):e.resume()}}function et(e,i){if(wt(e))zt("reverseTimeline: invalid timeline");else{var t=e.progress();if(t<1&&Ji(e),!wt(i)&&!wt(i.duration)){var n=i.duration;e.totalDuration(n)}e.reverse()}}function it(i){e.getElement(i)}function tt(i){e.getElement(i)}function nt(i){if(!e.isObject(i))return[];if(ye(i.id)){var t=ve(i);return t.tweens}return gsap.getTweensOf(i)}function lt(e,i){if(!wt(e)){var t="hidden";i&&(t="visible"),kt(e,{visibility:t})}}function rt(i){if(!wt(Tn)){Tn.innerHTML=Mt;var t=In.instructions.l1,n=Cn.textSpanPrefix+"1",l=In.instructions.l2,r=Cn.textSpanPrefix+"2",a=In.instructions.l3,s=Cn.textSpanPrefix+"3",o=Mt;i||(i=Mt,e.isEmptyString(t)||(o=at(t,o),t=e.wrapInSpanElement(t,n),i+=t),e.isEmptyString(l)||(Ft("displayInstructions: processing line2 "+l),o=at(l,o),l=e.wrapInSpanElement(l,r),i=e.addSuffixIfNotThere(i,Cn.textLineBreak),i+=l),e.isEmptyString(a)||(Ft("displayInstructions: processing line3 "+a),o=at(a,o),a=e.wrapInSpanElement(a,s),i=e.addSuffixIfNotThere(i,Cn.textLineBreak),i+=a));var c=Cn.textFontSize,u=Tt(o,c,Tn);Tn.style.fontSize=Mt+u+"px",Tn.style.fontFamily=Cn.textFontFamily,Tn.innerHTML=i;var d=e.getChildElement(Tn,e.toCssIdQuery(n));wt(d)||(d.style.opacity=0);var f=e.getChildElement(Tn,e.toCssIdQuery(r));wt(f)||(f.style.opacity=0);var v=e.getChildElement(Tn,e.toCssIdQuery(s));if(wt(v)||(v.style.opacity=0),In.instructions.isVisible=!0,ct(Tn,In.instructions),Cn.textSpanIsFadeIn){var p=Cn.textSpanFadeTimeSec,h=Cn.textSpanFadeStaggerTimeSec;wt(d)||gsap.to(d,{duration:p,autoAlpha:1,ease:"power1.in"}),wt(f)||gsap.to(f,{delay:h,duration:p,autoAlpha:1,ease:"power1.in"}),wt(v)||gsap.to(v,{delay:2*h,duration:p,autoAlpha:1,ease:"power1.in"})}else wt(d)||(d.style.opacity=1),wt(f)||(f.style.opacity=1),wt(v)||(v.style.opacity=1)}}function at(i,t){var n=e.removeMarkup(i);return n.length>t.length?n:t}function st(e){return Cn.textFontType+Ot+e+"px "+Cn.textFontFamily}function ot(){wt(Tn)||(Tn.innerHTML=Mt,In.instructions.isVisible=!1,ct(Tn,In.instructions))}function ct(i,t){var n=q(t);wt(t.bckgCol)||(n.background=t.bckgCol),e.setElementStyleProperty(i,n)}function ut(e,i){wt(e)||(i||f(),Vt(e.tiles)&&(i?ft(e.tiles):vt(e.tiles)),Vt(e.centreShape)&&dt(e.centreShape,In.centreShape,"centreShape"),Vt(e.innerCircle)&&dt(e.innerCircle,In.innerCircle,"innerCircle"),Vt(e.outerCircle)&&dt(e.outerCircle,In.outerCircle,"outerCircle"),Vt(e.actions)&&ht(e.actions),Vt(e.zoomLevel)&&Wi(e.zoomLevel),Vt(e.instructions)&&Qi(e.instructions),Vt(e.stageAlpha)&&Bi(e.stageAlpha))}function dt(e,i,t){wt(e)||wt(i)||(i.isVisible=e.isVisible,De(i,t))}function ft(i){if(e.isArray(i)){for(var t=[],n=0;n<i.length;n++){var l=i[n];if(e.isObject(l)){var r=l.state,a=pe(r.id),s=l.tileText,o=a.txt;a.isActive;a.isActive=r.isActive,a.isVisible=r.isVisible,a.isPlaying=r.isPlaying,a.isPlayingNext=r.isPlayingNext,a.isPlayed=r.isPlayed,a.clickCount=r.clickCount,o.value=s.value,o.isVisible=s.isVisible,t.push(a)}else zt("processSeverTilesStateDelta: invalid server tile")}pt(t)}}function vt(i){if(e.isArray(i)&&e.isArray(i[0])){for(var t=[],n=0;n<i.length;n++)for(var l=i[n],r=0;r<l.length;r++){var a=i[n][r],s=In.tiles[n][r],o=a.id,c=s.id;if(o===c){var u=a.state,d=a.tileText,f=s.txt;xt(s,u)&&St(f,d)||(s.isActive=u.isActive,s.isVisible=u.isVisible,s.isPlaying=u.isPlaying,s.isPlayingNext=u.isPlayingNext,s.isPlayed=u.isPlayed,s.clickCount=u.clickCount,f.value=d.value,f.isVisible=d.isVisible,t.push(s))}else zt("processSeverTilesState: Server id "+o+"and client id "+c+"not identical")}pt(t)}}function pt(i){Ft("Have "+i.length+" tile changes");for(var t=0;t<i.length;t++){var n=i[t],l=e.getElement(n.id)
;!n.isPlayed&&n.isVisible&&n.isActive||!n.isSelected||(n.isSelected=!1),Me(n),Oe(n,l),Ie(n,l),Ce(n,l),n.isPlaying&&(In.playingTileId=n.id)}_()}function ht(i){var t=null,n=null,l=[],r={};if(e.isArray(i))for(var a=0;a<i.length;a++){var s=i[a];Vt(s.id)&&(t=s.id),Vt(s.actionType)&&(n=s.actionType),Vt(s.elementIds)&&(l=s.elementIds),Vt(s.params)&&(r=s.params),yt(t,n,l,r)}}function yt(e,i,t,n){if(Ft("doAction: "+e+" actionType: "+i),!wt(i)&&!wt(t))switch(i){case"ACTIVATE":zi(e,t,n);break;case"ANIMATION":break;case"DEACTIVATE":Oi(e,t,n);break;case"VISIBLE":break;case"INVISIBLE":mt(t);break;case"ZOOM":Ye(t);break;case"TIMELINE":Ze(e,t,n);break;case"ROTATE":Si(e,t,n);break;case"ALPHA":Ii(e,t,n);break;case"AUDIO":_e(e,t,n);break;case"RESET":Ei(e,t,n);break;case"STOP":Ni(e,t,n);break;default:zt("doAction: Unknown actionType: "+i)}}function mt(i){if(!wt(i))if(e.isArray(i))for(var t=0;t<i.length;t++)gt(i[t]);else gt(i)}function gt(i){if(!wt(i)){var t=e.getElement(i);if(ye(i)){var n=ve(t);if(wt(n))return;n.isVisible=!1,Oe(n,t)}}}function xt(e,i){return!wt(e)&&!wt(i)&&(e.id===i.id&&(e.isVisible===i.isVisible&&e.isActive===i.isActive&&e.isPlaying===i.isPlaying&&e.isPlayingNext===i.isPlayingNext&&e.clickCount===i.clickCount&&e.isPlayed===i.isPlayed))}function St(e,i){return!wt(e)&&!wt(i)&&(e.isVisible===i.isVisible&&e.value===i.value)}function bt(e){if(!wt(e)){var i=e.progress();i>0?e.restart():e.play()}}function Pt(){return e.getElement(Cn.instructionTxtElementId)}function Tt(e,i,t){var n=1;l.innerWidth||r.documentElement.clientWidth||r.body.clientWidth;var a=l.innerHeight||r.documentElement.clientHeight||r.body.clientHeight,s=(st(n),t.clientWidth),o=s*Cn.textWidthCompressor,c=a*Cn.textAreaMax;n=Ct(e,i,o),n=It(s,n,c);var u=Cn.textMaxFontSize;return n>u&&(n=u),n}function It(e,i,t){var n=st(i),l=i,r=Et(n,e,t);if(r<0)return l;var a=r*Cn.textNumberOfLines,s=t/a;return s<1&&(l*=s),l}function Ct(e,i,t){var n=st(i),l=At(n,e),r=l.width;if(r<=0||r>t||Math.abs(t-r)<1)return i;var a=t/r,s=i*a;return Ct(e,s,t)}function At(e,i){var t=In.fontCanvas,n=In.canvasCtx;return n.fillRect(0,0,t.width,t.height),n.textBaseline="top",n.fillStyle=Wt,n.font=e,n.measureText(i)}function Et(e,i,t){var n=In.fontCanvas,l=In.canvasCtx;n.width=i,n.height=t,l.fillRect(0,0,n.width,n.height),l.textBaseline="top",l.fillStyle=Wt,l.font=e;var r="gM";l.fillText(r,0,0);for(var a=l.getImageData(0,0,n.width,n.height).data,s=-1,o=-1,c=0;c<n.height;c++)for(var u=0;u<n.width;u++){var d=4*(c*n.width+u);if(0!==a[d]){-1===s&&(s=c);break}if(u===n.width-1&&-1!==s){o=c,c=n.height;break}}var f=(o-s)*Cn.textHeightCompressor;return f}function kt(i,t){e.setElementAttributes(i,t)}function wt(i){return e.isNull(i)}function Vt(i){return e.isNotNull(i)}function zt(i){e.logError(i)}function Ft(i){e.log(i)}const Lt="DEV",Mt="",Ot=" ",Dt="m",Rt="ELEMENT_SELECTED",Nt="elementId",Gt="selected",Ut="fill",jt="visible",Bt="hidden",Wt="#FFFFFF",Ht="#000000",Qt="#CCFFCC",Xt="#00FF00",qt="#C0C0C0",Yt="#2F4F4F",Zt="#696969",_t="#4B4B4B",Jt="#FFA500",Kt="#DC143C",$t=204,en=0,tn="#666666",nn={r:102,g:102,b:102},ln=Zt,rn=_t,an=Zt,sn=Wt,on=Yt,cn=Yt,un=Wt,dn=Wt,fn=Ht,vn=Kt,pn=Qt,hn=Jt,yn=qt,mn=Xt,gn="@TILE_TEXT@",xn="Arial";var Sn=["/audio/violin-tuning.mp3","/audio/UnionRoseE2m.mp3","/audio/UnionRoseE3.mp3","/audio/UnionRoseE4.mp3","/audio/UnionRoseE5.mp3","/audio/UnionRose-m1.mp3"],bn=null,Pn=null,Tn=null,In={tiles:[],tileCircles:[],centreShape:{isVisible:!1,gsapTimeline:{},gsapExplodeTimeline:{}},innerCircle:{isVisible:!1,gsapTimeline:{},gsapExplodeTimeline:{}},outerCircle:{isVisible:!1,gsapTimeline:{},gsapExplodeTimeline:{}},instructions:{isVisible:!1,l1:Mt,l2:Mt,l3:Mt,bckgCol:"rgba(225, 225, 225, 0.85)"},selectedTileId:null,playingTileId:null,fontCanvas:null,canvasCtx:null,speech:{isPlaySpeechSynthOnClick:!1,speechText:"I, I clicked on "+gn,speechVoice:"random",speechIsInterrupt:!0},stageAlpha:1},Cn={connectionPreference:"ws,sse,poll",centre:{x:762,y:762},circleRadii:[55,92,125,194,291,401,552,750],outerFrameRadius:2e3,lineEnd:{x:762,y:12},lineLen:750,lineAngles:[0,45,90,135,180,225,270,315],tileAngles:[0,45,90,135,180,225,270,315,360],viewMinPoint:0,viewMaxPoint:1525,zoomCentreSmall:"700 700 124 124",zoomCentreShape:"660 660 204 204",zoomInnerCircleSmall:"540 540 444 444",zoomInnerCircle:"471 471 582 582",zoomOuterCircleSmall:"350 350 824 824",zoomOuterCircle:"471 471 582 582",zoomFull:"0 0 1525 1525",circlePrefix:"c",linePrefix:"l",tilePrefix:"t",overlayPrefix:"o",tilePlayLinePrefix:"pl",selectedPrefix:"s",tileRotationDuration:2,tileRotationAngle:45,tileRotationYoyo:!1,tileRotationReps:0,tileCircleGroupPrefix:"ctg",tileGroupPrefix:"g",tileTextElementPrefix:"x",tileTextPathElementPrefix:"px",tileTextElementPathPrefix:"hx",tileTextSpanPrefix:"sp",stageParentId:"stage",overlayParentId:"overlay",stageId:"stageCircle",frameParentId:"frame",outerFrameId:"outerFrame",elementIdDelimiter:"-",svgArcs:[null,null,null,null,null,null,null,null],gridParentId:"grid",gridStyle:{fill:"none",stroke:"aqua","stroke-width":"2px"},stageStyle:{fill:fn,"stroke-width":"0px","stroke-opacity":"0","pointer-events":"none"},stageVisibilityStyle:{opacity:In.stageAlpha,visibility:"visible"},tilesParentId:"tiles",frameStyle:{fill:dn,"stroke-width":"0px","stroke-opacity":"0",visibility:"visible",opacity:1},tileStyleOverlayPlayingNext:{fill:"none",stroke:hn,"stroke-width":"1px","stroke-linecap":"round",visibility:"visible",opacity:1,"pointer-events":"none"},tileStyleOverlayPlaying:{fill:"none",stroke:pn,"stroke-width":"1px","stroke-linecap":"round",visibility:"visible",opacity:1,"pointer-events":"none"},tileStyleOverlaySelected:{fill:"none",stroke:vn,"stroke-width":"2px","stroke-linecap":"round",visibility:"visible",opacity:1,"pointer-events":"none"},tileStyleSelectedPath:{fill:"none",stroke:vn,"stroke-width":"7px",visibility:"visible",opacity:1,"pointer-events":"none"},tileStyleConnectorPath:{fill:"none",stroke:vn,"stroke-width":"2px",visibility:"visible",opacity:1,"pointer-events":"none"},tileStyleVisible:{fill:an,stroke:yn,"stroke-width":"2px","pointer-events":"all",visibility:"visible",opacity:1},tileStyleActive:{fill:ln,stroke:yn,"stroke-width":"2px","pointer-events":"all",visibility:"visible",opacity:1},tileStyleInActive:{fill:sn,stroke:yn,"stroke-width":"2px","pointer-events":"all",visibility:"visible",opacity:1},tileStyleInvisible:{visibility:"hidden"},tileStyleOnPonterEntry:{fill:on},tileStyleSelected:{fill:cn,stroke:yn,"stroke-width":"2px",visibility:"visible",opacity:1},tileStylePlayed:{visibility:"hidden"},tileStylePlaying:{fill:rn,stroke:yn,"stroke-width":"1px",visibility:"visible",opacity:1},tileStylePlayingNext:{stroke:yn,"stroke-width":"2px",visibility:"visible",opacity:1},tileStyleTextPathDef:{fill:"none",stroke:"none"},tileStyleTextElement:{visibility:"visible",opacity:1},tileStyleTextElementInvisible:{visibility:"hidden"},tileStyleTorusTextPathElement:{startOffset:"50%","text-anchor":"middle",fill:un,stroke:"none"},tileStylePieTextPathElement:{startOffset:"90%","text-anchor":"end",fill:un,stroke:"none"},tileStyleInvertedPieTextPathElement:{startOffset:"10%","text-anchor":"start",fill:un,stroke:"none"},tileStyleTextSpan:{"font-family":xn,"dominant-baseline":"middle"},tileTextMinLength:5,tileTextSizeMultiplier:{torus:.8,pie:.7},tileStylePlayLine:{fill:"none",stroke:mn,"stroke-width":"4px","stroke-linecap":"round",visibility:"visible",opacity:1,"pointer-events":"none"},tileStylePlayLineInactive:{visibility:"hidden",opacity:0},shapeStyleInvisible:{visibility:"hidden"},shapeStyleVisible:{visibility:"visible"},shapeTimelineDuration:60,shapeExplodeDuration:5,instructionTxtElementId:"instructionTxt",textLineBreak:"<br/>",textStyleInvisible:{visibility:"hidden"},textStyleVisible:{visibility:"visible"},textFontFamily:"Arial",textFontType:"normal",textFontSize:50,textMaxFontSize:70,textMaxLineLen:30,textHeightCompressor:1.1,textWidthCompressor:.9,textAreaMax:.4,textNumberOfLines:3,textSpanPrefix:"is",textSpanIsFadeIn:!0,textSpanFadeTimeSec:1,textSpanFadeStaggerTimeSec:.5,appUrlHttp:"/htp",appUrlSse:"/sse",appUrlWebsockets:"/wsoc",zoomDuration:3,all:"ALL",testTextElementId:"testTxt",colModPerClick:-20,maxColModPerClick:-150,overlayInDuration:12,tilePlaylineAlphaDur:.5};const An=Cn.linePrefix.length+Cn.overlayPrefix.length+Cn.tilePlayLinePrefix.length,En=Cn.overlayPrefix+Cn.tilePlayLinePrefix,kn=Cn.linePrefix+Cn.overlayPrefix+Cn.tilePlayLinePrefix;return{load:function(){u()},createSvgTile:R,initTiles:x,setTileText:W}}(zsUtil,zsNet,zsSvg,zsAudio,window,document);