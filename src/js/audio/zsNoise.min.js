var zsNoise=function(n){"use strict";function e(n){this.message=n,this.name="ZsNoiseException"}function t(){d("resetConfig: NOISE"),R.masterGainVal=0}function i(t,i){if(!n)throw new e("Invalid libraries. Required: zsUtil");if(d("Init Noise"),!t)return v("_initNoise: invalid context"),void u(!1);V=t,g(i)&&(i=V.destination),p=m(),p.gain.value=0,p.connect(i),u(!0)}function a(){return g(M)?(M=r(),M.connect(p),M):M}function r(){var n=V.createBufferSource();const e=2*V.sampleRate,t=V.createBuffer(1,e,V.sampleRate),i=t.getChannelData(0);for(let n=0;n<e;n++)i[n]=2*Math.random()-1;return n.buffer=t,n}function o(){T&&!g(M)&&(M.stop(),M.disconnect(),M=null,T=!1)}function s(n){if(N&&!g(p)){g(n)&&(n=R.masterGainVal);var e=a();if(!g(e)){var t=f();T||p.gain.setValueAtTime(0,t),c(n,R.fadeInMs),T||(e.loop=!0,e.start()),T=!0}}}function u(n){g(n)||(d("setReady: "+n),N=n)}function l(){return N}function c(e,t){if(V&&p){n.isString(e)&&(e=n.toFloat(e));var i=R.masterGainVal;if(n.isNumeric(e)){i=e,i<0?i=0:i>1&&(i=1);var a=R.masterGainVal,r=p.gain.value;if(a!==i&&(R.masterGainVal=i),r!==i)if(!g(t)&&n.isNumeric(t)){var o=n.msecToSec(t),s=f(),u=i/4,l=s+o/2,c=i,m=s+o;0===i?(u=0,c=0):u=i<r?r-u:r+u,d("setMasterGain: v1: "+u+" v2: "+c+" t1: "+l+" t2: "+m+" g: "+i+" currentValue: "+r),p.gain.linearRampToValueAtTime(u,l),p.gain.linearRampToValueAtTime(c,m)}else p.gain.setValueAtTime(i,f())}else v("_setMasterGain: Invalid gain level: "+e)}else v("setMasterGain: invalid context of master gain")}function f(){return g(V)?0:V.currentTime}function m(){return V?V.createGain():(v("_createGainNode: Audio context is not initialised!!"),null)}function v(e){n.logError(e,G)}function d(e){n.log(e,G)}function g(e){return n.isNull(e)}const G="ZsNoise: ";var V=null,N=!1,p=null,T=!1,M=null,R={masterGainVal:0,fadeInMs:500,fadeOutMs:500};return{init:function(n,e){i(n,e)},reset:function(){t()},setGain:function(n,e){c(n,e)},isReady:function(){return l()},play:function(n){return s(n)},stop:function(n){return o(n)}}}(zsUtil);