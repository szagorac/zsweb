var zsNoise=function(e){"use strict";function n(e){this.message=e,this.name="ZsNoiseException"}function t(){V("resetConfig: NOISE"),q.masterGainVal=0}function i(t,i){if(!e)throw new n("Invalid libraries. Required: zsUtil");if(V("Init Noise"),y&&s(),!t)return T("_initNoise: invalid context"),void c(!1);N=t,g(i)&&(i=N.destination),R=d(),R.gain.value=0,q.isUseFilter&&(q.filterMaxValue=N.sampleRate/2,q.filterNumberOfOctaves=Math.log(q.filterMaxValue/q.filterMinValue)/Math.LN2,h=N.createBiquadFilter(),h.type=q.filterType,h.frequency.value=q.filterFreq,h.Q.value=q.filterQ,h.connect(R)),R.connect(i),c(!0)}function a(e){G&&!g(h)&&h.frequency.linearRampToValueAtTime(e,N.currentTime+q.rampSec)}function r(e){G&&!g(h)&&h.Q.linearRampToValueAtTime(e,N.currentTime+q.rampSec)}function l(e){G&&!g(h)&&(h.type=e)}function u(){return g(F)?(F=o(),g(h)?F.connect(R):F.connect(h),F):F}function o(){var e=N.createBufferSource();const n=2*N.sampleRate,t=N.createBuffer(1,n,N.sampleRate),i=t.getChannelData(0);for(let e=0;e<n;e++)i[e]=2*Math.random()-1;return e.buffer=t,e}function s(){y&&!g(F)&&(F.stop(),F.disconnect(),F=null,y=!1)}function f(e){if(G&&!g(R)){g(e)&&(e=q.masterGainVal);var n=u();if(!g(n)){var t=v();y||R.gain.setValueAtTime(0,t),p(e,q.fadeInMs),y||(n.loop=!0,n.start()),y=!0}}}function c(e){g(e)||(V("setReady: "+e),G=e)}function m(){return G}function p(n,t){if(N&&R){e.isString(n)&&(n=e.toFloat(n));var i=q.masterGainVal;if(e.isNumeric(n)){i=n,i<0?i=0:i>1&&(i=1);var a=q.masterGainVal,r=R.gain.value;if(a!==i&&(q.masterGainVal=i),r!==i)if(!g(t)&&e.isNumeric(t)){var l=e.msecToSec(t),u=v(),o=i/4,s=u+l/2,f=i,c=u+l;0===i?(o=0,f=0):o=i<r?r-o:r+o,R.gain.linearRampToValueAtTime(o,s),R.gain.linearRampToValueAtTime(f,c)}else R.gain.setValueAtTime(i,v())}else T("_setMasterGain: Invalid gain level: "+n)}else T("setMasterGain: invalid context of master gain")}function v(){return g(N)?0:N.currentTime}function d(){return N?N.createGain():(T("_createGainNode: Audio context is not initialised!!"),null)}function T(n){e.logError(n,M)}function V(n){e.log(n,M)}function g(n){return e.isNull(n)}const M="ZsNoise: ";var N=null,G=!1,R=null,y=!1,F=null,h=null,q={masterGainVal:0,isUseFilter:!0,filterQMultiplier:30,filterMinValue:100,filterMaxValue:1e3,filterNumberOfOctaves:1,filterFreq:1e3,filterType:"bandpass",filterQ:100,fadeInMs:500,fadeOutMs:500,rampSec:2};return{init:function(e,n){i(e,n)},reset:function(){t()},setGain:function(e,n){p(e,n)},isReady:function(){return m()},isRunning:function(){return y},play:function(e){return f(e)},stop:function(e){return s(e)},setFilterFreq:function(e){a(e)},setFilterQ:function(e){r(e)},setFilterType:function(e){l(e)}}}(zsUtil);