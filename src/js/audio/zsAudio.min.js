var zsAudio=function(n,t,i,o,a,e){"use strict";function r(n){this.message=n,this.name="ZsAudioException"}function u(n,t,i){this.context=n,this.urlList=t,this.onload=i,this.bufferList=new Array,this.loadCount=0}function l(a,f){if(!(n&&t&&i&&o))throw new r("Invalid libraries. Required: zsUtil, zsGranulator and zsSpeech");try{if(T("initAudio: "),!H){var c=e.AudioContext||e.webkitAudioContext||e.mozAudioContext||e.oAudioContext;H=new c,T("initAudio:  created audio context")}if(n.isNotNull(f)&&(j=f),"suspended"===H.state)return T("initAudio: Context suspended, resuming context : "+H.state),F>=q?void T("initAudio: breached MAX Resume Retry Count, giving up ..."):(H.resume(),1===F&&(H.onstatechange=function(){T("initAudio: on AudioContext state change to: "+H.state)}),e.hasOwnProperty("speechSynthesis")&&e.speechSynthesis.getVoices(),F++,void setTimeout(function(){l(a,f)},1e3));T("initAudio: AudioContext state: "+H.state),n.isArray(a)?Z=a:B("Invalid audio files to load array");var d=new u(H,Z,s);d.load()}catch(n){U=!1,B("Web Audio API is not supported in this browser")}}function s(t){O=t,n.isNotNull(j)?j():(G(),y(),C(0),_()),U=!0}function f(){return k(H)?0:H.currentTime}function c(){}function d(t,i){if(H){n.isString(t)&&(t=n.toFloat(t));var o=W;n.isNumeric(t)?(o=t,o<0?o=0:o>1&&(o=1),W=o,p(W,i)):B("_setMasterVolume: Invalid gain level: "+t)}else B("_setMasterVolume: invalid context")}function p(n,t){A(n),m(n,t),x(n),I(n,t),v(n,t),g(n,t)}function G(){if(k(i))return B("_initSpeech: Can not initialise speech"),void(i=null);i.init()}function g(n,t){i.setVolume(n)}function v(n,t){i.setMaxVolume(n)}function y(){k(o)?B("_playAudioBuffer: Invalid granulator"):o.init(H,O)}function h(n,t,i,a){!k(o)&&U?o.play(n,t,i,a):B("_playAudioBuffer: Invalid granulator")}function m(n,t){!k(o)&&U?o.setGain(n,t):B("_setPlayerVolume: Invalid granulator")}function A(n){!k(o)&&U?o.setMaxGain(n):B("_setPlayerMaxVolume: Invalid granulator")}function C(n,i){if(k(t))return B("initGranulator: Can not initialise zsGranulator"),void(t=null);k(n)&&(n=0),k(i)&&(i=H.destination),n<0||n>=O.length?B("initGranulator: invalid buffer index"):t.init(H,O[n],i)}function x(n){k(t)?B("setGranulatorRampLinear: Invalid granulator"):t.setMaxGain(n)}function I(n,t){R("masterGainVal",n,t)}function R(n,i,o){k(t)?B("setGranulatorRampLinear: Invalid granulator"):t.addRampLinear(n,i,o)}function S(n,i,o,a){!k(t)&&U?t.addRampSin(n,i,o,a):B("setGranulatorRampSin: Invalid granulator")}function L(n,t){I(n,t)}function P(n){!k(t)&&U?t.setGrainEnvelope(n):B("setGranulatorEnvelope: Invalid granulator")}function V(n){!k(t)&&U?t.setGranulatorConfig(n):B("setGranulatorConfig: Invalid granulator")}function z(n){!k(t)&&U?t.setGrainConfig(n):B("setGranulatorGrainConfig: Invalid granulator")}function w(n){!k(t)&&U?k(n)?B("setGranulatorPlayDuration: invalid duration"):t.setPlayDuration(n):B("setGranulatorPlayDuration: Invalid granulator")}function b(){!k(t)&&U?t.isReady()?t.play():T("playGranulator: Granulator is not initialised, can not play"):B("playGranulator: Invalid granulator")}function M(){!k(t)&&U?t.isReady()?t.stop():T("stopGranulator: Granulator is not initialised, can not stop"):B("stopGranulator: Invalid granulator")}function N(){!k(t)&&U?t.reset():B("stopGranulator: Invalid granulator")}function _(n){a&&(k(a)?a=null:a.init(H,n))}function D(n){a.play(n)}function E(){a.stop()}function B(t){n.logError(t,X)}function T(t){n.log(t,X)}function k(t){return n.isNull(t)}const X="zsAudio: ",q=3;var H=null,U=!1,F=1,O=null,W=1,Z=["/audio/violin-tuning.mp3"],j=null;return u.prototype.loadBuffer=function(n,t){var i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType="arraybuffer";var o=this;i.onload=function(){o.context.decodeAudioData(i.response,function(i){i?(o.bufferList[t]=i,++o.loadCount==o.urlList.length&&o.onload(o.bufferList)):B("error decoding file data: "+n)},function(n){B("decodeAudioData error",n)})},i.onerror=function(){B("BufferLoader: XHR error")},i.send()},u.prototype.load=function(){for(var n=0;n<this.urlList.length;++n)this.loadBuffer(this.urlList[n],n)},{init:function(n,t){l(n,t)},initSpeech:function(){G()},initPlayer:function(){y()},initGranulator:function(n){C(n)},initNoise:function(){_()},isReady:function(){return U},playAudio:function(n,t,i,o){h(n,t,i,o)},setGranulatorRampLinear:function(n,t,i){R(n,t,i)},setGranulatorRampSin:function(n,t,i,o){S(n,t,i,o)},setGranulatorGain:function(n,t){L(n,t)},setGranulatorEnvelope:function(n){P(n)},setGranulatorConfig:function(n){V(n)},setGranulatorGrainConfig:function(n){z(n)},setGranulatorPlayDuration:function(n){w(n)},playGranulator:function(){b()},stopGranulator:function(){M()},resetGranulator:function(){N()},isSpeachReady:function(){return i.isReady()},speak:function(n,t,o){return i.speak(n,t,o)},stopSpeach:function(){return i.stop()},setSpeechConfig:function(n){return i.setSpeechConfig(n)},playNoise:function(n){D(n)},stopNoise:function(){E()},rumpLinearSpeechParam:function(n,t,o){return i.rampLinearConfigParam(n,t,o)},reset:function(){c()},getCurrentTime:function(){return f()},setMasterVolume:function(n,t){return d(n,t)},setPlayerVolume:function(n,t){return m(n,t)},setPlayerMaxVolume:function(n,t){return A(n,t)},setSpeechVolume:function(n,t){return g(n,t)},setGranulatorVolume:function(n,t){return I(n,t)}}}(zsUtil,zsGranulator,zsSpeech,zsPlayer,zsNoise,window);