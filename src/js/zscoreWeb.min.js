var zscore=function(t,e,n,i,o,c,r){"use strict";function s(t){this.message=t,this.name="ZScoreException"}function l(){if(!it.isInitialised){if(!(t&&e&&n&&i&&o))throw new s("Invalid libraries. Required: zsUtil, zsNet, zsSvg, zsAudio and zsMusic");t.setRunMode(D),O("init: "),et=t.isTouchDevice(),nt=t.isSafari(navigator),O("init: IsTouch Device: "+et+" isSafari: "+nt),it.fontCanvas=r.createElement("canvas"),it.canvasCtx=it.fontCanvas.getContext("2d"),t.listen("resize",c,v),t.listen("orientationchange",c,v),d(),p(),f(),it.isInitialised=!0}}function a(){it.isInitialised?(O("onStateBtnClick: zscore initialised"),e.isConnected()||(O("onStateBtnClick: zscore not connected, reconnecting..."),k())):(O("onStateBtnClick: initialising"),l())}function u(){S()}function d(){e.init(ot.connectionPreference,ot.appUrlSse,ot.appUrlWebsockets,ot.appUrlHttp,I,T)}function f(){U(i)?N("initAudio: invalid zsAudio lib"):i.init(tt,0)}function S(){U(i)?N("resetAudio: invalid zsAudio lib"):i.reset()}function p(){n.init()}function v(e){if(!t.isObject(this))return null}function T(t,n){switch(t){case e.OPEN:b(n);break;case e.CLOSED:m(n);break;case e.ERROR:y(n);break;default:N("Unknown Connection Event State: "+t+" for type: "+n)}}function b(t){O(t+" connection opened."),w(t)}function m(t){O(t+" connection closed."),B(t)}function y(t){O(t+" connection error."),x(t)}function w(t){it.isConnected=!0,it.connectionType=t,it.reconnectAttmpts=0,C(ot.connectedRectStyle,ot.connectedBtnAttrib,ot.connectedTxtStyle,M)}function B(t){it.isConnected=!1,C(ot.disconnectedRectStyle,ot.disconnectedBtnAttrib,ot.disconnectedTxtStyle,W),k(t)}function x(t){it.isConnected=!1,C(ot.errorRectStyle,ot.errorBtnAttrib,ot.errorTxtStyle,j),k(t)}function C(e,n,i,o){var c=t.getElement(ot.idServerStatusRect);U(c)||z(c,e);var r=t.getElement(ot.idServerStatusBtn);U(r)||R(r,n);var s=t.getElement(ot.idServerStatusTxt);U(s)||(z(s,i),s.textContent=o)}function k(t){e.reconnect(t,!0)}function I(t,e){it.isConnected||w(),U(t)||(e||u(),P(t.scoreInfo)&&g(t.scoreInfo),P(t.actions)&&h(t.actions))}function g(e){if(t.isObject(e)&&P(e.title)){var n=e.title;E(n)}}function E(e){var n=t.getElement(ot.idTitle);U(n)||(n.textContent=e)}function h(e){var n=null,i=null,o=[],c={};if(t.isArray(e))for(var r=0;r<e.length;r++){var s=e[r];P(s.id)&&(n=s.id),P(s.actionType)&&(i=s.actionType),P(s.elementIds)&&(o=s.elementIds),P(s.params)&&(c=s.params),A(n,i,o,c)}}function A(t,e,n,i){if(O("doAction: "+t+" actionType: "+e),!U(e)&&!U(n))switch(e){case"TIMELINE":break;default:N("doAction: Unknown actionType: "+e)}}function z(e,n){t.setElementStyleProperty(e,n)}function R(e,n){t.setElementAttributes(e,n)}function U(e){return t.isNull(e)}function P(e){return t.isNotNull(e)}function N(e){t.logError(e)}function O(e){t.log(e)}const D="DEV",M="Connected",W="Reconnecting",j="Error",H="green",L="red",V="orange",Z="white",q="black",K=H,Y=L,F=V,G=H,J=L,Q=V,X=Z,$=Z,_=q;var tt=["/audio/violin-tuning.mp3"],et=null,nt=null,it={isRunning:!1,tsBaseBeatMaps:{},startTimeTl:0,currentBeatId:"b0",tempo:{},topStaveTimeline:{},bottomStaveTimeline:{},lastTimelineBeatNo:0,currentTickTimeSec:0,nextBeatTickTimeSec:0,audioTlBeatTime:0,audioTickBeatTime:0,instrument:"Part View",title:"ZScore",isConnected:!1,isInitialised:!1,connectionType:null},ot={connectionPreference:"ws,sse,poll",defaultConnectionType:e.WEBSOCKET,appUrlHttp:"/htp",appUrlSse:"/sse",appUrlWebsockets:"/wsoc",tsBaseBeatDenom:8,tsY:0,beatIdPrefix:"b",tweenIdPrefix:"tw",beatTweenIdPrefix:"btw",ballTweenIdPrefix:"bltw",idTitle:"title",idServerStatusRect:"srvrStatusRect",idServerStatusTxt:"srvrStatusTxt",idServerStatusBtn:"srvrStatBtn",connectedRectStyle:{fill:K,stroke:G,"stroke-width":"0px",visibility:"visible",opacity:1},disconnectedRectStyle:{fill:Y,stroke:J,"stroke-width":"1px",visibility:"visible",opacity:1},errorRectStyle:{fill:F,stroke:Q,"stroke-width":"1px",visibility:"visible",opacity:1},connectedTxtStyle:{fill:X},disconnectedTxtStyle:{fill:$},errorTxtStyle:{fill:_},connectedBtnAttrib:{filter:""},disconnectedBtnAttrib:{filter:"url(#dropshadow)"},errorBtnAttrib:{filter:"url(#dropshadow)"}};return{onStateBtn:function(){a()},onInstrumentSelect:function(t){O("onInstrumentSelect: "+t)},onInstrumentControl:function(t){O("onInstrumentControl: "+t)}}}(zsUtil,zsNet,zsSvg,zsAudio,zsMusic,window,document);